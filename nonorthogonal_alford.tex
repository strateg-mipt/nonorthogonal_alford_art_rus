% !TeX spellcheck = ru_RU
\documentclass[a4paper,11pt]{article}
\usepackage[process=auto]{pstool}
\usepackage[english,russian]{babel}
\usepackage[T2A]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{amssymb,amsmath}
\usepackage{gensymb,textcomp,latexsym}
\usepackage{graphicx}
\usepackage{tabularx}
\usepackage[pdftex, left=1in, right=1in, top=1in, bottom=2cm]{geometry}
\usepackage{parcolumns}
\usepackage{multirow}
\usepackage{tikz}

%\usepackage[usenames,dvipsnames]{xcolor}
%\usepackage[font=small,labelfont=bf]{caption}
\usepackage[center]{subfigure}
\renewcommand{\thesubfigure}{(\asbuk{subfigure})~}
\newcommand{\figref}[1]{Рис.~\ref{#1}}
\usepackage[pdfauthor={Shchelik},pdftitle={Nonorthogonal Alford test},pdfstartview=XYZ,bookmarks=true,colorlinks=true,linkcolor=blue,urlcolor=blue,citecolor=blue,
bookmarks=true,linktocpage=true,hyperindex=true]{hyperref}
%\usepackage[hyperpageref]{backref}

%\usepackage[section]{placeins}
%\usepackage{graphicx}
%\usepackage{epsfig}
%\usepackage{epstopdf}
%\usepackage{subfigure}
\usepackage{float}
%\floatstyle{boxed}
%\restylefloat{figure}
%\usepackage{booktabs}
%\graphicspath{ {./image_test/} }

\newcommand{\ii}{\mathrm{i}}

\newcounter{modelnum}
\newcommand{\modelnum}[1]{\refstepcounter{modelnum}Модель \themodelnum #1}

%Filters counters
\newcounter{wfiltnum}
\newcommand{\wfiltnum}[1]{\refstepcounter{wfiltnum}ОФ-\thewfiltnum #1}
\newcounter{lffiltnum}
\newcommand{\lffiltnum}[1]{\refstepcounter{lffiltnum}НЧФ-\thelffiltnum #1}
\newcounter{hffiltnum}
\newcommand{\hffiltnum}[1]{\refstepcounter{hffiltnum}ВЧФ-\thehffiltnum #1}
%tabularx options
\newcolumntype{C}{>{\centering}X}


\begin{document}
\part*{Анализ поляризации дипольных волн в нецилиндрических скважинах в анизотропной породе}
\today

\section{Введение}
Уже несколько десятилетий в акустическом каротаже широко и достаточно успешно практикуются методики кросс-дипольных измерений. Современные решения в технике и обработке полученных данных позволяют количественно производить оценку азимутальной и аксиальной (по отношению к стволу скважины) анизотропии для широкой группы горных пород. Существенный прогресс в определении параметров породы в рамках модели трансверсально-изотропного (ТИ) тела по скоростям распространения поперечных волн называется рядом специалистов главным достижением методов акустического каротажа последних лет. Кросс-дипольные измерения также могут быть использованы для определения ориентации крупных трещин и обнаружения анизотропии, индуцированной подземными горизонтальными напряжениями и трещиноватостью \cite{Patterson2001}.

Как известно, принцип работы данного метода основан на существовании в ТИ породе двух ортогональных выделенных направлений, что в общем случае приводит к поляризации распространяющихся по стволу скважины поперечных волн. При наличии измерений от двух направленных ортогонально-ориентированных источников в скважине возможно определить направления главных осей ТИ модели и скорости распространения поляризованных поперечных волн. В основе классического метода определения лежит допущение о симметричности матрицы измерений (составленной из данных четырёх измерений с различной ориентацией источников и приёмников), которая может быть приведена к диагональному виду ортогональным преобразованием \cite{Alford1986}. В ряде практических случаев ортогональность направлений поляризации поперечных волн отсутствует, но в однородной породе симметрия матрицы измерений сохраняется и существуют возможности её диагонализации другими способами \cite{Dellinger1998}. Помимо неортогональности на результат работы классического алгоритма может влиять наличие сильных горизонтальных напряжений, приводящих к нарушению ТИ модели и эффекту пересечения дисперсионных кривых быстрой и медленной волн. Результаты работы алгоритма становятся при этом зависимыми от ширины выбранного временного окна, что свидетельствует о зависимости направления поляризации волн от частоты \cite{Nolte1997}. Другим фактором, влияющим на поляризацию и разделение волн в скважине, является нецилиндрическая форма поперечного сечения ствола \cite{Seroices2010}. В сочетании с анизотропными свойствами горной породы отклонения от цилиндрической формы могут приводить к проблемам определения направлений главных осей стандартными методами.

В данной работе рассматривается вопрос определения главных направлений ТИ породы по измерениям в скважинах эллиптического сечения, являющихся модельным приближением более общих несимметричных форм скважин. В качестве исходных данных используются результаты численного трёхмерного моделирования с помощью метода спектральных элементов \cite{Komatitsch2000}. Для анализа структуры волнового поля в скважинах на определённой частоте применяется полуаналитический метод конечных элементов (SAFE) \cite{Bartoli2006}. Результаты расчётов сопоставляются с данными, получаемыми классическим алгоритмом Alford rotation \cite{Alford1986} и его альтернативной неортогональной модификации \cite{Dellinger1998} с применением оконной и частотной фильтрации и без неё.

\section{Дипольный каротаж скважин и классический подход к обработке}
В устройство классического прибора дипольного каротажа входят два массива приёмников и источников направленного действия ортогонально ориентированных друг к другу. Свяжем с ориентацией этих массивов оси X и Y локальной системы координат прибора. В ходе работы прибора на выходе получают четыре разных массива значений давления от времени, обозначаемых XX, XY, YX и YY, где первая буква обозначает активный в момент проведения измерения массив источников, а вторая - приемников. Данные, полученные с приемников на определенном расстоянии от источника, принято записывать в форме матрицы $\mathbf{R}$ 

\begin{equation}
	\mathbf{R} = \left\|
	\begin{array}{cc}
	\text{XX} & \text{YX} \\
	\text{XY} & \text{YY} \\
	\end{array}
	\right\| 
	\label{eq:R_matrix}
\end{equation}

Известно, что в однородной недисперсионной среде с ТИ типом симметрии в произвольном направлении могут распространятся три вида плоских волн (квазипродольная, поперечная и квазипоперечная) с ортогональными векторами поляризации \cite{Musgrave1970}. В рамках классического подхода приближение плоских волн используется для описания волновых процессов в скважине. Дипольные излучатели возбуждают преимущественно моды с поперечным характером колебаний, которые распространяются вдоль скважины независимо. В данных предположениях исходную матрицу измерений \eqref{eq:R_matrix} возможно привести к диагональному виду \cite{Dellinger1998}
\begin{equation}
	\mathbf{R} = \mathbf{P} \ \mathbf{D} \ \mathbf{P}^T, \label{eq:alford_symmetric} 
\end{equation}
здесь $\mathbf{D}$ - диагональная матрица, содержащая сигналы независимых дипольных мод; матрица $\mathbf{P}$ проецирует сигналы отдельных мод на оси локальной системы координат прибора. Если направления поляризации дипольных волн ортогональны, то матрица преобразования $\mathbf{P}$ сводится к повороту на некоторый угол $\theta$

\begin{equation*}
	\mathbf{P} = \left\|
	\begin{array}{cc}
	\cos \theta &-\sin \theta \\ 
	\sin \theta & \cos \theta
	\end{array} 
	\right\| 
\end{equation*}

Алгоритм поиска этого угла был представлен в работе \cite{Alford1986} и получил название Alford rotation. Хотя на практике полевые данные не обладают абсолютной симметрией, искомый угол может быть найден из условия минимизации энергии недиагональных компонент по всему интервалу времени измерений. Отметим, что данный подход корректно работает только при сохранении ориентации главных направлений вдоль всего пути распространения волны.

Заметим, что ортогональная поляризации изгибных мод не всегда наблюдается на практике. В ряде случаев, например при распространении волн в анизотропной породе с орторомбическим типом симметрии \cite{Dellinger2001} или в случае анизотропии вызванной наличием трещин \cite{Nolte1996}, было доказано, что поляризация волн может быть существенно неортогональной. 

Один из возможных вариантов обобщения Alford rotation на неортогональный случай был рассмотрен в работе \cite{Dellinger1998} и заключается в введении дополнительного угла $\eta$, характеризующего ориентацию главных направлений. Утверждается, что если для системы справедливо представление \eqref{eq:alford_symmetric}, то матрица преобразования будет иметь вид:
\begin{align*}
\mathbf{P} &= \left\|
\begin{array}{cc}
\cos \theta & -\sin (\theta+\eta) \\ 
\sin \theta & \cos (\theta+\eta)
\end{array} 
\right\|
\end{align*}
где, за $\theta$ принимается угол отсчитываемый против часовой стрелки между осью $X$ и направлением поляризации первой моды, а за $\theta + \eta$ - угол между направлением поляризации второй моды и осью $Y$. Поиск значений углов производится путем минимизация энергии недиагональных компонент матрицы $\mathbf{D}$ по двум параметрам. При $\eta=0$ метод сводится к классическому Alford rotation. 

Как известно, нарушение цилиндрической формы ствола скважины в изотропной породе также приводит к появлению двух изгибных мод \cite{Seroices2010}. Если главные направления анизотропной породы не совпадают с направлениями деформации ствола, то влияние этих двух факторов приводит к нарушению предположения классического метода (а также его неортогонального обобщения) о разделении изгибных мод. Из-за частотной зависимости влияния геометрии и сильной дисперсии изгибных волн, эффективное направление поляризации может меняться по мере удаления приемников от источника.
Применение методов оконной и частотной фильтрации в ряде случаев может уменьшить ошибку работы классических алгоритмов. Однако универсального подхода, способного корректировать влияние геометрии ствола на точность определения главных направлений анизотропной породы, в настоящее время не предложено. В разделе \ref{comparison_alford} производится оценка точности ортогонального и неортогонального Alford rotation на основе синтетических данных трехмерного моделирования распространения волн в быстрой ТИ породы в скважинах эллиптического сечения.  

\section{Вычислительные методы}

В качестве исходных данных каротажных измерений используются результаты прямого моделирования распространения волн методом спектральных элементов (SEM). Ранее данный метод успешно применялся для расчета задач геофизики \cite{Komatitsch1999} и моделирования акустического каротажа \cite{Charara2011}. Численный алгоритм производит решение уравнений линейно-упругого анизотропного тела в породе и акустических уравнений для невязкой жидкости внутри скважины с соответствующими условиями на границе раздела фаз. Подробное описание и формулировка метода приводится в работе \cite{Komatitsch1999}. Используемая в работе реализация производит основные расчеты на графических процессорах (GPU).

Основная обработка и анализ данных, в том числе и Alford rotation, проводились средствами MATLAB. Для построения дисперсионных кривых нормальных мод использовался алгоритм, основанный на модифицированном методе Прони \cite{Ekstrom1995}. При обработке данных измерений в некоторых случаях применялись оконные, низкочастотные и высокочастотные фильтры сигнала, реализованные в MATLAB.   

Для анализа решения в частотной области в предположении однородности среды и геометрии по Z был выбран более простой и быстрый полуаналитический метод конечных элементов (SAFE) \cite{Bartoli2006}. Формулировка метода основана на Фурье разложения искомой функции вдоль направления оси скважины, что позволяет свести задачу к набору двухмерных постановок. Приведем краткое описание метода. Предполагая гармоническую зависимость от времени вида $\mathrm{e}^{-\ii\omega t}$ для смещений $\mathbf{u}$, деформаций $\boldsymbol{\varepsilon}$ и напряжений $\boldsymbol{\sigma}$, уравнения движения твёрдого тела в вариационной форме могут быть представлены в виде:

\begin{equation}
\int_{V}^{(s)}\delta \boldsymbol{\varepsilon}^* \boldsymbol{\sigma} dV - \omega^2 \int_{V}^{(s)} \rho_s \delta \mathbf{u}^*\mathbf{u}dV = \int_{V}^{(s)}\delta \mathbf{u}^* \mathbf{f} dV + \int_{\partial V}^{(s)}\delta \mathbf{u}^* \mathbf{t} d\Gamma, \label{var_eq_solid}
\end{equation}
здесь $\mathbf{f}$, $\mathbf{t}$ -- векторы объёмных и поверхностных сил, $\rho_s$ -- плотность, тензор напряжений $\boldsymbol{\sigma}$ связан с тензором деформаций $\boldsymbol{\varepsilon}$ для упругого тела через закон Гука:
$$
\boldsymbol{\sigma} = \mathbf{C}\boldsymbol{\varepsilon}.
$$

При описании движения невязкой жидкости будем пользоваться формулировкой уравнений в терминах потенциала скорости $\phi$: $\ii \omega \mathbf{u}_f = \nabla \phi$. Тогда давление в жидкости определяется выражением $p = -\ii \omega \rho_f \phi$, а уравнения движения для жидкой среды в вариационной форме имеют вид: 

\begin{equation}
\int_{V}^{(f)} \delta (\nabla\phi)^* \rho_f  \nabla \phi dV - \omega^2 \int_{V}^{(f)}  c^{-2} \rho_f \delta \phi^*  \phi dV = \frac{1}{\ii\omega}\int_{\partial V}^{(f)} \rho_f \delta(\nabla \phi)^* \mathbf{t} d\Gamma + \frac{1}{\ii\omega} \int_{V}^{(f)} \delta(\nabla \phi)^* \mathbf{f} dV, \label{var_eq_fluid}
\end{equation}
где $c$ -- скорость звука в жидкости.

Свяжем вертикальную ось скважины с направлением оси Z системы координат и применим преобразование Фурье по z к исходным уравнениям. Для каждого элемента из сетки конечных элементов в плоскости поперечного сечения скважины значения искомых величин аппроксимируем системой базисных функций $N_j(x,y)$ \cite{Zienkiewicz2000}:

\begin{equation}
\begin{split}
\mathbf{u}^{(e)}(x,y,z,t) &= \left[
\begin{array}{c}
\sum_{j=1}^{n}N_j(x,y)U_{x}^{(j)} \\
\sum_{j=1}^{n}N_j(x,y)U_{y}^{(j)} \\
\sum_{j=1}^{n}N_j(x,y)U_{z}^{(j)} 
\end{array}
\right] \mathrm{e}^{\ii (kz-\omega t)} % = \mathbf{N}_u(x,y) \mathbf{U}^{(e)}(k,\omega) e^{\ii (kz-\omega t)}, 
\\
\phi^{(e)}(x,y,z,t) &= \left(\sum_{j=1}^{n}N_j(x,y)\psi^{(j)} \right) \cdot \mathrm{e}^{\ii (kz-\omega t)} % = \mathbf{N}_{\phi}(x,y) \mathbf{\Phi}^{(e)}(k,\omega) e^{\ii (kz-\omega t)}, 
\\
\end{split} \label{eq:unknown_var}
\end{equation}
где $n$ -- число узлов в элементе c номером $e$.  

С учётом условий на границе раздела жидкости и твёрдого тела при подстановке неизвестных \eqref{eq:unknown_var} в уравнения \eqref{var_eq_solid} и \eqref{var_eq_fluid} задача сводится к системе линейных уравнений \cite{Bartoli2006,Treyssede2013}:
\begin{equation}
(\mathbf{K}_1 + \ii k \mathbf{K}_2 + k^2 \mathbf{K}_3 - \omega^2 \mathbf{M} + \ii \omega \mathbf{P}) \hat{\mathbf{U}} = \hat{\mathbf{F}} \label{eq:eigen_equation}
\end{equation}
где матрицы $\mathbf{K}_1$, $\mathbf{K}_2$, $\mathbf{K}_3$, $\mathbf{M}$, $\mathbf{P}$ формируются из значений объёмных и поверхностных интегралов в уравнениях \eqref{var_eq_solid} и \eqref{var_eq_fluid} на элементах, а $ \hat{\mathbf{U}}$ состоит из значений искомых величин $\mathbf{U}^{(j)}$ и $\psi^{(j)}$ в узлах каждого элемента. 

Для каждого заданного значения частоты $\omega$  можно рассмотреть обобщённую задачу на собственные значения для матрицы уравнения \eqref{eq:eigen_equation}, решением которой являются пары собственных значений и векторов $[k_m, \hat{\mathbf{U}}_m]$, соответствующие различным волновым модам системы. Отбором собственных векторов были выделены компоненты волнового поля, соответствующие дипольным модам в скважине. Значение выбранного собственного решения в области скважины определяет направление поляризации моды на конкретной частоте. По данным на совокупности частот в определенном диапазоне была проанализирована частотная зависимость поляризации волн. Сравнение результатов моделирования таких зависимостей с данными, полученными прямой обработкой временных измерений с приемников, приведены в разделе \ref{safe_comparison}.

\section{Результаты обработки Alford rotation}
\label{comparison_alford}
Влияние несимметричности формы скважины на результат работы упомянутых алгоритмов определения главных направлений анизотропного тела рассмотрим на примере эллиптических скважин в ТИ породах  Bakken Shale и Cotton Valey Shale. Обе породы относятся к классу глинистых сланцев и имеют скорость распространения поперечных волн превышающую скорость звука в жидкости в скважине (быстрые породы). Значение упругих постоянных материалов приведены в таблице \ref{tab:properties}. Ось симметрии ТИ породы наклонена по отношению к оси скважины под углом 90\textdegree (HTI), в плоскости поперечного сечения скважины ось повернута относительно осей эллипса на $\theta = 45$\textdegree. Определение угла $\theta$ является задачей алгоритма. В расчетах использовались скважины размерами полуосей $12.70 \times 10.16$ см ($5 \times 4$ дюймов) и $15 \times 10$ см с соотношением полуосей эллипса соответственно 25\% и 50\%. 
%Полное описание рассматриваемых моделей можно найти в таблице \ref{tab:models_description}. 

Метод спектральных элементов (SEM) использовался для моделирования результатов каротажных измерений, полученные записи с приёмников были поданы на вход исследуемых алгоритмов обработки. В качестве сигнала дипольного акустического источника в скважине была взята производная вейвлета Блэкмана-Харриса с центральной частотой 4 кГц. Полученные в результате обработки значения углов приведены в таблице \ref{tab:std_process_results}. 

%Параметры быстрой породы, $\rho = 2640$ кг/м$^3$, $V_P = 5219$ м/с, $V_S = 3257$ м/с.
\begin{table}[H]
\footnotesize
%\centering
\caption{Параметры упругих анизотропных материалов}
\renewcommand{\arraystretch}{1.5}
\begin{tabularx}{\textwidth}{|C|c|c|c|c|c|c|c|}
\hline \multirow{2}{*}{Название}  & Плотность & \multicolumn{6}{c|}{Упругие модули, ГПа} \\ 
\cline{3-8}  & кг/м$^3$ & $C_{11}$ & $C_{12}$ & $C_{13}$ & $C_{33}$ & $C_{44}$ & $C_{66}$ \\ \hline
\hline Cotton Valey Shale & 2640 & 74.73 & 14.75 & 25.29 & 58.84 & 22.05 & 29.99 \\ 
\hline Bakken Shale & 2230 & 40.9 & 10.3 & 8.5 & 26.9 & 10.5 & 15.3 \\ 
\hline 
\end{tabularx} 
\label{tab:properties}
\renewcommand{\arraystretch}{1.0}
\end{table}

%\begin{table}[h]
%\footnotesize
%\centering
%\caption{Параметры модельных задач}
%\renewcommand{\arraystretch}{1.5}
%\begin{tabularx}{\textwidth}{|C|c|l|}
%\hline  Обозначение & Геометрия, см & Материал породы \\ \hline
%\hline \textbf{}\modelnum{\label{mnum: 11}}& Эллиптическая $12.70 \times 10.16$ & Bakken Shale \\ % Bakken Shale ($12.70 \times 10.16$)
%\hline \textbf{}\modelnum{\label{mnum: 10}}& Эллиптическая $15.00 \times 10.00$ & Bakken Shale \\ % Bakken Shale ($15.00 \times 10.00$)
%\hline \textbf{}\modelnum{\label{mnum: 12}}& Эллиптическая $12.70 \times 10.16$ & Cotton Valey Shale \\ % Cotton Valey Shale ($12.70 \times 10.16$)
%\hline \textbf{}\modelnum{\label{mnum: 9}}& Эллиптическая $15.00 \times 10.00$ & Cotton Valey Shale \\ % Cotton Valey Shale ($15.00 \times 10.00$)
%\hline 
%\end{tabularx}
%\label{tab:models_description}
%\renewcommand{\arraystretch}{1.0}
%\end{table}

После поворота на найденный угол матрица измерений в идеальном случае должна стать диагональной. Величина $E_{rel}$ отношения суммы квадратов значений недиагональных компонент полученной матрицы к диагональным характеризует степень адекватности применяемых методик и достоверность результатов. На модельных данных в недиагональных компонентах остается от 1\% до 3\% энергии. При этом значения углов значительно отличаются от заданного значения в 45\textdegree. Для сравнения, при обработке модельных измерений для цилиндрической скважины в анизотропной породе $E_{rel}$ имеет существенно меньшие значения порядка $10^{-5}\%$ для обоих алгоритмов и точное совпадение значений углов. 

Применение модифицированного метода Прони \cite{Ekstrom1995} к исходным трассам измерений позволяет построить дисперсионные кривые для гармоник сигнала с наиболее высокой амплитудой. В моделируемых задачах они соответствуют двум главным дипольным модам (рис. \ref{fig:disp_curves_all}). Аналогичные кривые также были построены по результатам расчётов полуаналитическим методом конечных элементов (SAFE) и нанесены на графики для проверки точности. Опираясь на дисперсионные кривые, можно выделить диапазон низких частот, в котором скорость распространения волн оказывается ближе всего к скоростям поперечных волн в породе. 

Как видно из таблицы \ref{tab:filter_process_results}, обработка данных, пропущенных через низкочастотный фильтр выделенного диапазона, может давать оценки углов, значительно отличающиеся от нефильтрованного случая. Также отметим что, при обработке фильтрованных данных наблюдается заметная неортогональность между направлениями поляризации дипольных мод на низких частотах и почти полностью ортогональная ориентация вдоль осей деформации формы скважины на высоких частотах. Следующий раздел будет посвящен более подробному обсуждению вопроса связи этих результатов с настоящей физической поляризацией распространяющихся волн.

\begin{table}[h]
\footnotesize
%\centering
\caption{Результаты обработки исходных данных алгоритмами Alford rotation}
\renewcommand{\arraystretch}{1.5}
\begin{tabularx}{\textwidth}{|X|rr|rr|r|rr|}
\hline	
				&\multicolumn{1}{c}{$\theta_1^o$} & \multicolumn{1}{c|}{$\theta_1^n$} & \multicolumn{1}{c}{$\theta_2^o$} & \multicolumn{1}{c|}{$\theta_2^n$} & \multicolumn{1}{c|}{$\Delta\theta^n$}& \multicolumn{1}{c}{$E_{rel}^o, \%$} & \multicolumn{1}{c|}{$E_{rel}^n, \%$} \\ \hline
\hline Bakken Shale ($12.70 \times 10.16$) & 15.56 & 14.72 & -74.44 & -73.92  & 1.36  & 3.0 & 3.0 \\
\hline Bakken Shale ($15.00 \times 10.00$) & 8.39 & 8.12 & -81.61 & -81.56 & 0.32 & 1.7 & 1.7 \\
\hline Cotton Valey Shale ($12.70 \times 10.16$) & 3.26 & 3.04 & -86.74 & -86.66  & 0.30 & 0.8 & 0.8 \\ 
\hline Cotton Valey Shale ($15.00 \times 10.00$) & 1.63 & 1.78 & -88.37 & -88.42  & 0.00  & 0.6 & 0.6 \\	   
 	   \hline
\end{tabularx} 
\begin{flushleft}
* здесь $\theta_1^o,\theta_2^o$ и $\theta_1^n,\theta_2^n$ соответствуют результатам, полученным ортогональной и неортогональной версией алгоритма. Величина $E_{rel}$ обозначает отношение энергии недиагональных компонент матрицы измерений к полной энергии.
\end{flushleft}
\label{tab:std_process_results}
\renewcommand{\arraystretch}{1.0}
\end{table}

\begin{table}[h]
\footnotesize
\centering
\caption{Результаты расчетов с применением фильтров}
\renewcommand{\arraystretch}{1.5}
\begin{tabularx}{\textwidth}{|X|rr|rr|r|rr|}
\hline
				&\multicolumn{1}{c}{$\theta_1^o$} & \multicolumn{1}{c|}{$\theta_1^n$} & \multicolumn{1}{c}{$\theta_2^o$} & \multicolumn{1}{c|}{$\theta_2^n$} & \multicolumn{1}{c|}{$\Delta\theta^n$}& \multicolumn{1}{c}{$E_{rel}^o, \%$} & \multicolumn{1}{c|}{$E_{rel}^n, \%$} \\ \hline
\hline	\textbf{Bakken Shale ($12.70 \times 10.16$)} & \textbf{15.56} & \textbf{14.72} & \textbf{-74.44}  & \textbf{-73.92}  & \textbf{1.36}  & \textbf{3.0} & \textbf{3.0} \\
		-//-//- с НЧФ \ref{lffnum: 3} & 49.41 & 40.46 & -40.59 & -35.41  & 14.13 & 2.0 & 1.2\\
		-//-//- с ВЧФ \ref{hffnum: 1} & 14.01 & 13.25 & -75.99 & -75.58  & 1.17 & 0.4 & 0.4\\
\hline	\textbf{Bakken Shale ($15.00 \times 10.00$)} & \textbf{8.39} & \textbf{8.12} & \textbf{-81.61}  & \textbf{-81.56} & \textbf{0.32}  & \textbf{1.7} & \textbf{1.7} \\
		-//-//- с НЧФ \ref{lffnum: 3} & 41.21 & 25.71 & -48.79 & -31.97  & 32.32 & 22.1 & 20.0\\
		-//-//- с ВЧФ \ref{hffnum: 2} & 7.54 & 10.22 & -82.46 & -82.63  & 2.84 & 1.1 & 1.0\\
\hline	\textbf{Cotton Valey Shale ($12.70 \times 10.16$)} & \textbf{3.26} & \textbf{3.04} & \textbf{-86.74}  & \textbf{-86.66}  & \textbf{0.30}  & \textbf{0.8} & \textbf{0.8}\\
		-//-//- с НЧФ \ref{lffnum: 4} & 48.42 & 39.73 & -41.58 & -35.50  & 14.77  & 9.7 & 7.0 \\
		-//-//- с ВЧФ \ref{hffnum: 3} & 2.77 & 3.26 & -87.23 & -87.43  & 0.69  & 0.45 & 0.45\\	
\hline	\textbf{Cotton Valey Shale ($15.00 \times 10.00$)} & \textbf{1.63} & \textbf{1.78} & \textbf{-88.37}  & \textbf{-88.42}  & \textbf{0.00}  & \textbf{0.6} & \textbf{0.6} \\
		-//-//- с НЧФ \ref{lffnum: 4} & 6.03 & 7.73 & -83.97 & -56.60  & 25.67  & 7.9 & 7.3 \\
		-//-//- с ВЧФ \ref{hffnum: 3} & 1.49 & 2.04 & -88.51 & -88.71  & 0.74  & 1.8 & 1.8\\		
\hline	
\end{tabularx} 
\begin{flushleft}
* здесь $\theta_1^o,\theta_2^o$ и $\theta_1^n,\theta_2^n$ соответствуют результатам, полученным ортогональной и неортогональной версией алгоритма. Величина $E_{rel}$ обозначает отношение энергии недиагональных компонент матрицы измерений к полной энергии.
\end{flushleft}
\label{tab:filter_process_results}
\renewcommand{\arraystretch}{1.0}
\end{table}


\section{Сравнение с SAFE}
\label{safe_comparison}

Применение SAFE позволяет сопоставить ранее полученные значения углов с рассчитанными направлениями поляризации дипольных мод в рамках используемой математической модели породы. После применения частотной фильтрации к исходному сигналу выделим частоту в спектре сигналов приемников с максимальной энергией и построим собственные решения для двух дипольных мод на этой частоте. Учитывая более узкий частотный диапазон в фильтрованном сигнале, поляризация этих решений по нашему предположению должно быть близко результатам обработки Alford rotation. На рисунке \ref{fig:bs10_8_HTI45} приведено сравнение значений углов из таблицы \ref{tab:filter_process_results} для моделей в породе Bakken Shale с рассчитанными профилями амплитуды давления собственных векторов на частотах 3.29 кГц и 5.52 кГц, соответствующих максимумам энергии в спектре фильтрованных данных. Аналогичные данные для Cotton Valey Shale представлены на рисунке \ref{fig:cs15_10_HTI45}.

\begin{figure}[h]
\centering
\begin{minipage}{0.49\linewidth}
	\centering \textbf{Bakken Shale ($12.70 \times 10.16$)}
	\psfragfig[width=0.49\linewidth,crop=pdfcrop]{./images/nonorth_alford/el10x8_inch_HTI_BS_f45_disp_modes+SAFE} \\
\end{minipage}
\begin{minipage}{0.49\linewidth}
	\centering \textbf{Bakken Shale ($15.00 \times 10.00$)}
	\psfragfig[width=0.49\linewidth,crop=pdfcrop]{./images/nonorth_alford/el15x10_HTI_BS_f45_disp_modes+SAFE} \\
\end{minipage}
\begin{minipage}{0.49\linewidth}
	\centering \textbf{Cotton Valey Shale ($12.70 \times 10.16$)}
	\psfragfig[width=0.49\linewidth,crop=pdfcrop]{./images/nonorth_alford/el10x8_inch_HTI_CS_f45_disp_modes+SAFE} \\
\end{minipage}
\begin{minipage}{0.49\linewidth}
	\centering \textbf{Cotton Valey Shale ($15.00 \times 10.00$)}
	\psfragfig[width=0.49\linewidth,crop=pdfcrop]{./images/nonorth_alford/el15x10_HTI_CS_f45_disp_modes+SAFE_new} \\
\end{minipage}
\caption{Дисперсионные кривые для основных задач. }
\label{fig:disp_curves_all}
\end{figure}

\begin{figure}[h]
%\centering
\renewcommand{\arraystretch}{1.5}
\begin{tabular*}{1\textwidth}{c|cc|cc|}
\cline{2-5}
&\multicolumn{2}{c|}{\textbf{Bakken Shale ($12.70 \times 10.16$)}} &\multicolumn{2}{c|}{\textbf{Bakken Shale ($15.00 \times 10.00$)}}\\ 
\begin{minipage}{0.02\textwidth}
\rotatebox{90}{\footnotesize \textit{Дипольная мода 1}} 
\end{minipage}&
\begin{minipage}{0.22\textwidth}
	\psfragfig[width=0.23\textwidth,crop=pdfcrop]{./images/SAFE/SAFE_BS_10x8_HTI_45/P_s_3_3kHz}		
\end{minipage}&
\begin{minipage}{0.22\textwidth}
	\psfragfig[width=0.23\textwidth,crop=pdfcrop]{./images/SAFE/SAFE_BS_10x8_HTI_45/P_s_5_5kHz}		
\end{minipage}&
\begin{minipage}{0.22\textwidth}
	\psfragfig[width=0.23\textwidth,crop=pdfcrop]{./images/SAFE/SAFE_BS_15x10_HTI_45/P_s_3_3kHz}		
\end{minipage}&
\begin{minipage}{0.22\textwidth}
	\psfragfig[width=0.23\textwidth,crop=pdfcrop]{./images/SAFE/SAFE_BS_15x10_HTI_45/P_s_5_5kHz}		
\end{minipage}\\ 
%& & & & \\
\begin{minipage}{0.02\textwidth}
\rotatebox{90}{\footnotesize \textit{Дипольная мода 2}} 
\end{minipage} &
\begin{minipage}{0.22\textwidth}
	\psfragfig[width=0.23\textwidth,crop=pdfcrop]{./images/SAFE/SAFE_BS_10x8_HTI_45/P_a_3_3kHz}		
\end{minipage} &
\begin{minipage}{0.22\textwidth}
	\psfragfig[width=0.23\textwidth,crop=pdfcrop]{./images/SAFE/SAFE_BS_10x8_HTI_45/P_a_5_5kHz}		
\end{minipage} &
\begin{minipage}{0.22\textwidth}
	\psfragfig[width=0.23\textwidth,crop=pdfcrop]{./images/SAFE/SAFE_BS_15x10_HTI_45/P_a_3_3kHz}		
\end{minipage} &
\begin{minipage}{0.22\textwidth}
	\psfragfig[width=0.23\textwidth,crop=pdfcrop]{./images/SAFE/SAFE_BS_15x10_HTI_45/P_a_5_5kHz}		
\end{minipage} \\ 
& \footnotesize НЧФ, 3.2895 кГц & \footnotesize ВЧФ, 5.5263 кГц & \footnotesize НЧФ, 3.2895 кГц & \footnotesize ВЧФ, 5.5263 кГц \\ \cline{2-5}
\end{tabular*}
\renewcommand{\arraystretch}{1.0}
\footnotesize
\begin{tabular*}{\textwidth}{@{\extracolsep{\fill} }crccc}
& 						 	& \tikz \draw (0,0) -- (1cm,0);  	& \tikz \draw[dashed] (0,0) -- (1cm,0);  	& \tikz \draw[dashdotted] (0,0) -- (1cm,0); \\
& Результаты обработки 		& \textit{ортогональный} 			& \textit{ортогональный} 					& \textit{неортогональный}    			\\
& Alford rotation:			& \textit{без фильтрации}		 	& \textit{с фильтрацией} 					& \textit{с фильтрацией} 	\\
\end{tabular*}
\renewcommand{\arraystretch}{1.0}
\normalsize
\caption{Сравнение результатов обработки фильтрованных данных измерений в породе Bakken Shale и направлений поляризации двух дипольных мод, полученными SAFE. Здесь НЧФ и ВЧФ обозначают тип примененной к исходным данным фильтрации (низкочастотная и высокочастотная соответственно), значение частоты соответствует отображенному решению SAFE для собственного вектора дипольной моды.}
\label{fig:bs10_8_HTI45}
\end{figure}

%\begin{figure}[h]
%\centering
%\begin{tabular*}{\textwidth}{@{\extracolsep{\fill} }crl}
%& \textit{Низкочастотная фильтрация} & \textit{Высокочастотная фильтрация}\\
%\end{tabular*}
%\begin{minipage}{0.04\linewidth}
%\rotatebox{90}{\textit{Дипольная мода 1}} 
%\end{minipage}
%\begin{minipage}{0.23\linewidth}
%	\psfragfig[width=0.24\linewidth,crop=pdfcrop]{./images/SAFE/SAFE_BS_15x10_HTI_45/P_s_2kHz}		
%\end{minipage}
%\begin{minipage}{0.23\linewidth}
%	\psfragfig[width=0.24\linewidth,crop=pdfcrop]{./images/SAFE/SAFE_BS_15x10_HTI_45/P_s_3_3kHz}		
%\end{minipage}
%\begin{minipage}{0.23\linewidth}
%	\psfragfig[width=0.24\linewidth,crop=pdfcrop]{./images/SAFE/SAFE_BS_15x10_HTI_45/P_s_5_5kHz}		
%\end{minipage}
%\begin{minipage}{0.23\linewidth}
%	\psfragfig[width=0.24\linewidth,crop=pdfcrop]{./images/SAFE/SAFE_BS_15x10_HTI_45/P_s_8_6kHz}		
%\end{minipage}
%\begin{minipage}{0.04\linewidth}
%\rotatebox{90}{\textit{Дипольная мода 2}} 
%\end{minipage}
%\begin{minipage}{0.23\linewidth}
%	\psfragfig[width=0.24\linewidth,crop=pdfcrop]{./images/SAFE/SAFE_BS_15x10_HTI_45/P_a_2kHz}		
%\end{minipage}
%\begin{minipage}{0.23\linewidth}
%	\psfragfig[width=0.24\linewidth,crop=pdfcrop]{./images/SAFE/SAFE_BS_15x10_HTI_45/P_a_3_3kHz}		
%\end{minipage}
%\begin{minipage}{0.23\linewidth}
%	\psfragfig[width=0.24\linewidth,crop=pdfcrop]{./images/SAFE/SAFE_BS_15x10_HTI_45/P_a_5_5kHz}		
%\end{minipage}
%\begin{minipage}{0.23\linewidth}
%	\psfragfig[width=0.24\linewidth,crop=pdfcrop]{./images/SAFE/SAFE_BS_15x10_HTI_45/P_a_8_6kHz}		
%\end{minipage}
%\vspace{\baselineskip}
%\renewcommand{\arraystretch}{1.0}
%\footnotesize
%\begin{tabular*}{\textwidth}{@{\extracolsep{\fill} }clclcl}
%\tikz \draw (0,0) -- (1cm,0); & ортогональный & \tikz \draw[dashed] (0,0) -- (1cm,0); & ортогональный & \tikz \draw[dashdotted] (0,0) -- (1cm,0); & неортогональный    \\
%& без фильтрации & & с фильтрацией & & с фильтрацией \\
%\end{tabular*}
%\renewcommand{\arraystretch}{1.0}
%\normalsize
%\caption{Результаты расчетов собственных векторов для Модели \ref{mnum: 10}}
%\label{fig:bs15_10_HTI45}
%\end{figure}

\begin{figure}[h]
%\centering
\renewcommand{\arraystretch}{1.5}
\begin{tabular*}{1\textwidth}{c|cc|cc|}
\cline{2-5}
&\multicolumn{2}{c|}{\textbf{Cotton Valey Shale ($12.70 \times 10.16$)}} &\multicolumn{2}{c|}{\textbf{Cotton Valey Shale ($15.00 \times 10.00$)}}\\
\begin{minipage}{0.02\linewidth}
\rotatebox{90}{\footnotesize\textit{Дипольная мода 1}} 
\end{minipage}&
\begin{minipage}{0.22\linewidth}
	\psfragfig[width=0.22\linewidth,crop=pdfcrop]{./images/SAFE/SAFE_CS_10x8_HTI_45/P_s_3_0kHz}		
\end{minipage}&
\begin{minipage}{0.22\linewidth}
	\psfragfig[width=0.22\linewidth,crop=pdfcrop]{./images/SAFE/SAFE_CS_10x8_HTI_45/P_s_7_2kHz}		
\end{minipage}&
\begin{minipage}{0.22\linewidth}
	\psfragfig[width=0.22\linewidth,crop=pdfcrop]{./images/SAFE/SAFE_CS_15x10_HTI_45/P_s_3_3kHz}		
\end{minipage}&
\begin{minipage}{0.22\linewidth}
	\psfragfig[width=0.22\linewidth,crop=pdfcrop]{./images/SAFE/SAFE_CS_15x10_HTI_45/P_s_5_5kHz}		
\end{minipage} \\
\begin{minipage}{0.02\linewidth}
\rotatebox{90}{\footnotesize\textit{Дипольная мода 2}} 
\end{minipage}&
\begin{minipage}{0.22\linewidth}
	\psfragfig[width=0.22\linewidth,crop=pdfcrop]{./images/SAFE/SAFE_CS_10x8_HTI_45/P_a_3_0kHz}		
\end{minipage}&
\begin{minipage}{0.22\linewidth}
	\psfragfig[width=0.22\linewidth,crop=pdfcrop]{./images/SAFE/SAFE_CS_10x8_HTI_45/P_a_7_2kHz}		
\end{minipage}&
\begin{minipage}{0.22\linewidth}
	\psfragfig[width=0.22\linewidth,crop=pdfcrop]{./images/SAFE/SAFE_CS_15x10_HTI_45/P_a_3_3kHz}		
\end{minipage}&
\begin{minipage}{0.22\linewidth}
	\psfragfig[width=0.22\linewidth,crop=pdfcrop]{./images/SAFE/SAFE_CS_15x10_HTI_45/P_a_5_5kHz}		
\end{minipage}\\
& \footnotesize НЧФ, 3.0256 кГц & \footnotesize ВЧФ, 7.1667 кГц & \footnotesize НЧФ, 3.0256 кГц & \footnotesize ВЧФ, 7.1667 кГц \\ \cline{2-5}
\end{tabular*}
\renewcommand{\arraystretch}{1.0}
\footnotesize
\begin{tabular*}{\textwidth}{@{\extracolsep{\fill} }crccc}
& 						 	& \tikz \draw (0,0) -- (1cm,0);  	& \tikz \draw[dashed] (0,0) -- (1cm,0);  	& \tikz \draw[dashdotted] (0,0) -- (1cm,0); \\
& Результаты обработки 		& \textit{ортогональный} 			& \textit{ортогональный} 					& \textit{неортогональный}    			\\
& Alford rotation:			& \textit{без фильтрации}		 	& \textit{с фильтрацией} 					& \textit{с фильтрацией} 	\\
\end{tabular*}
\renewcommand{\arraystretch}{1.0}
\normalsize
\caption{Сравнение результатов обработки фильтрованных данных измерений в породе Cotton Valey Shale и направлений поляризации двух дипольных мод, полученными SAFE. Здесь НЧФ и ВЧФ обозначают тип примененной к исходным данным фильтрации (низкочастотная и высокочастотная соответственно), значение частоты соответствует отображенному решению SAFE для собственного вектора дипольной моды.}
\label{fig:cs15_10_HTI45}
\end{figure}

Представленные данные хорошо демонстрируют, что неортогональная версия Alford rotation дает более близкие оценки направлений поляризации дипольных волн на низких частотах. Поляризация в этом частотном диапазоне практически не отличается для случаев с эллиптичностью 25\% и 50\%. При этом направления поляризации основных мод, полученные по результатам моделирования SAFE, не совпадают с заданной ориентацией оси симметрии трансверсально-изотропной породы. Этот факт подтверждает неприменимость классического подхода оценки главных направлений ТИ породы в задачах такого типа. 

Отметим, что близкие на первый взгляд к 45\textdegree  значения угла классического ортогонального Alford rotation являются лишь случайным совпадением осредненных реальных поляризаций мод на этих частотах с заданным значением в модели. В пользу последнего утверждения также говорит и тот факт, что энергия недиагональных компонент при ортогональной обработке почти на 10\% выше. 

Результаты обработки нефильтрованного сигнала в рассмотренных задачах, как видно из данных таблиц, близки ориентацией мод на высоких частотах. Интересно, что при этом поляризация мод почти ортогональна и может не совпадать геометрически с ориентацией полуосей эллипса поперечного сечения скважины, как в случае с изотропной породой. При увеличении степени эллиптичности ствола это различие сокращается. Таким образом, даже при корректной (с точки зрения диагонализации матрицы измерений) работе алгоритма полученное значение угла на направление главной оси анизотропного материала может не отвечать ни физическим свойствам породы, ни геометрии задачи. 
\clearpage

\section{Заключение}

Как следует из данного исследования, результаты обработки каротажных измерений в быстрых породах ортогональными и неортогональными методами, основанными на диагонализации матрицы измерений, в значительной части определяются поляризацией нормальных мод на высоких частотах. При этом на примере расчета задачи нецилиндрической скважины в породе Bakken shale показано, что эти результаты могут не соответствовать главным направлениям анизотропной породы, что является серьезным недостатком при оценке этого параметра в задачах интерпретации. 


Применение частотной фильтрации позволяет получить более точные оценки главных направлений анизотропной породы, однако требует учёта возможной неортогональности этих направлений. При исследовании пород с высокой степенью симметрии тензора упругих постоянных, ортогональность на низких частотах можно считать маркером корректности решения задачи. 

%Важным результатом данной работы является оценка точности работы упомянутых алгоритмов, а также демонстрация возможного существования ортогонально поляризованных волн в быстрых породах,  не связанных однозначно с одним из факторов. Для дипольных мод на средних частотах существует область с достаточно резкой сменой направлений поляризации, которая однако не имеет определяющего значения для работы алгоритма, так как спектр используемых источников значительно шире.

Приведённый в статье материал демонстрирует возможности спектральных методов, схожих с полуаналитическим методом конечных элементов (SAFE), по анализу и интерпретации отдельных аспектов волнового поля в скважинах. Имея полученные из данных каротажа оценки упругих свойств анизотропной породы, при помощи численного моделирования SAFE можно проводить коррекцию полученных значений направлений, опираясь на невязку с модельными углами на нескольких выбранных частотах в зависимости от частотного спектра источника. Высокая скорость расчетов, а также возможность расширения метода на среды с более общим типом анизотропии, среды с затуханием и преднапряженных пород, открывает широкие перспективы применения рассмотренной методики при обработке каротажных измерений.

%\include{include/tmp_short_description}
%\include{include/tmp_safe_pictures}


%\bibliography{./library/library}
%\include{include/var_bibliography_link}
%\bibliography{c:/Users/German/Documents/TeX_Library/library}
\bibliography{d:/Documents/Workfiles/Literature/TeX_Library/library}

\bibliographystyle{unsrt}
%\bibliographystyle{plainnat_no_url}

\appendix
\section{Фильтрация данных}

%\begin{minipage}[c]{0.47\linewidth}	
%\begin{center}
%		Ортогональный Alford rotation \\
%		\psfragfig[width=0.40\linewidth,crop=pdfcrop]{./images/nonorth_alford/el20x10_TTI60_rot4c_scheme}			
%	  		\label{fig:rot4_scheme}
%\end{center}	  		
%\end{minipage} \hfill
%\begin{minipage}[c]{0.47\linewidth}
%\begin{center}
%		Неортогональный Alford rotation\\
%			\psfragfig[width=0.40\linewidth,crop=pdfcrop]{./images/nonorth_alford/el20x10_TTI60_gs_rot4c_scheme}
%			\label{fig:rot4_gs_scheme}
%\end{center}
%\end{minipage} 	\\
\begin{table}[H]
\footnotesize
%\centering
\caption{Параметры применяемых фильтров}
\renewcommand{\arraystretch}{1.5}
\textbf{Низкочастотные фильтры} \\
\begin{tabularx}{\textwidth}{|C|c|c|c|c|}
\hline Обозначение & $A_{pass}, $ дБ & $A_{stop}, $ дБ & $F_{pass}, $ Гц & $F_{stop}, $ Гц \\ 
\hline \textbf{}\lffiltnum{\label{lffnum: 3}} & 1 & 80 & 3000 & 4000 \\ 
\hline \textbf{}\lffiltnum{\label{lffnum: 4}} & 1 & 80 & 3000 & 3500 \\ 
\hline 
\end{tabularx} \\
\textbf{Высокочастотные фильтры} \\
\begin{tabularx}{\textwidth}{|C|c|c|c|c|}
\hline Обозначение & $A_{pass}, $ дБ & $A_{stop}, $ дБ & $F_{pass}, $ Гц & $F_{stop}, $ Гц \\ \hline
\hline \textbf{}\hffiltnum{\label{hffnum: 1}} & 1 & 80 & 5000 & 4000 \\ 
\hline \textbf{}\hffiltnum{\label{hffnum: 2}} & 1 & 80 & 6000 & 5000 \\ 
\hline \textbf{}\hffiltnum{\label{hffnum: 3}} & 1 & 80 & 7000 & 6000 \\ 
\hline 
\end{tabularx}
\renewcommand{\arraystretch}{1.0}
\end{table}

\end{document} 