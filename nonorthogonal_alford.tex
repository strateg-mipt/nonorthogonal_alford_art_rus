% !TeX spellcheck = ru_RU
\documentclass[a4paper,11pt]{article}
\usepackage[process=auto]{pstool}
\usepackage[english,russian]{babel}
\usepackage[T2A]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{amssymb,amsmath}
\usepackage{gensymb,textcomp,latexsym}
\usepackage{graphicx}
\usepackage{tabularx}
\usepackage[pdftex, left=1in, right=1in, top=1in, bottom=2cm]{geometry}
\usepackage{parcolumns}
\usepackage{multirow}
\usepackage{tikz}

%\usepackage[usenames,dvipsnames]{xcolor}
%\usepackage[font=small,labelfont=bf]{caption}
\usepackage[center]{subfigure}
\renewcommand{\thesubfigure}{(\asbuk{subfigure})~}
\newcommand{\figref}[1]{Рис.~\ref{#1}}
\usepackage[pdfauthor={Shchelik},pdftitle={Nonorthogonal Alford test},pdfstartview=XYZ,bookmarks=true,colorlinks=true,linkcolor=blue,urlcolor=blue,citecolor=blue,
bookmarks=true,linktocpage=true,hyperindex=true]{hyperref}
%\usepackage[hyperpageref]{backref}

%\usepackage[section]{placeins}
%\usepackage{graphicx}
%\usepackage{epsfig}
%\usepackage{epstopdf}
%\usepackage{subfigure}
\usepackage{float}
%\usepackage{booktabs}
%\graphicspath{ {./image_test/} }

\newcounter{modelnum}
\newcommand{\modelnum}[1]{\refstepcounter{modelnum}Модель \themodelnum #1}

%Filters counters
\newcounter{wfiltnum}
\newcommand{\wfiltnum}[1]{\refstepcounter{wfiltnum}ОФ-\thewfiltnum #1}
\newcounter{lffiltnum}
\newcommand{\lffiltnum}[1]{\refstepcounter{lffiltnum}НЧФ-\thelffiltnum #1}
\newcounter{hffiltnum}
\newcommand{\hffiltnum}[1]{\refstepcounter{hffiltnum}ВЧФ-\thehffiltnum #1}
%tabularx options
\newcolumntype{C}{>{\centering}X}


\begin{document}
\part*{Неортогональный Alford rotation}
\today

%К вопросу о поляризации дипольных мод в нецилиндрических скважинах в анизотропной породе.
%
%- Введение
%    Обсуждение методики дипольного каротажа, задача определения направлений основных осей трансверсально-анизотропной породы. Обзор темы существования главных направлений в нецилиндрических скважинах. Феномен неортогональности, алгоритмы разделения мод. 
%
%- Дипольные моды в анизотропной среде. Дисперсионный подход, стандартный алгоритм Alford rotation. Феномен неортогональности, алгоритмы разделения мод. 
%- Неортогональность главных направлений и альтернативный метод обработки NOAR. Зависимость от частоты. Фильтрация сигнала.
%- SAFE как метод изучения отдельных базисных решений. Описание и применение
%
%- Сравнение результатов SAFE и NOAR.
%
%- Заключение.

\section{Введение}
Уже несколько десятилетий в акустическом каротаже широко и достаточно успешно практикуются методики кросс-дипольных измерений. Современные решения в технике и обработке полученных данных позволяют количественно производить оценку азимутальной и аксиальной (по отношению к стволу скважины) анизотропии для широкой группы горных пород. Существенный прогресс в определении параметров породы в рамках модели трансверсально-изотропного тела по скоростям распространения поперечных волн называется рядом специалистов главным достижением методов акустического каротажа последних лет. Помимо изучения внутренней анизотропии горной породы, кросс-дипольные измерения могут быть использованы для определения ориентации трещин и обнаружения анизотропии, индуцированной подземными горизонтальными напряжениями \cite{Patterson2001}.

Как известно, принцип работы данного метода основан на существовании в анизотропной породе двух ортогональных выделенных направлений, что в общем случае приводит к поляризации распространяющихся по стволу скважины поперечных волн. При наличии измерений от двух ортогонально-ориентированных направленных дипольных источников в скважине возможно определить направления главных осей анизотропии и скорости распространения поляризованных поперечных волн. В основе классического метода определения лежит допущение о симметричности матрицы составленной из компонент четырёх векторов измерений различной ориентации, которая может быть приведена к диагональному виду ортогональным поворотом на некоторый угол \cite{Alford1986}. В ряде практических случаев ортогональность направлений поляризации поперечных волн отсутствует, однако в однородной породе матрица измерений должна сохранять симметрию и может быть диагонализирована другими способами \cite{Dellinger1998}. Помимо неортогональности на результат работы классического алгоритма может влиять наличие сильных горизонтальных напряжений, приводящих к возникновению индуцированной анизотропии и эффекту пересечения дисперсионных кривых быстрой и медленной волн. В этом случае результат работы алгоритма становится зависимым от ширины временного окна при обработки, а следовательно направление поляризации волн изменяется с ростом частоты \cite{Nolte1997}. Другим фактором, влияющим на поляризацию и разделение волн в скважине, является неидеально цилиндрическая форма поперечного сечения ствола \cite{Seroices2010}. В сочетании с анизотропными свойствами горной породы отклонения от цилиндрической формы могут приводить к проблемам определения направлений главных осей стандартными методами [?].

В данной работе обсуждается вопрос определения главных направлений трансверсально-изотропной породы по измерениям в скважинах эллиптического сечения, являющихся модельным приближением более общих несимметричных форм скважин. В качестве исходных данных используются результаты численного трёхмерного моделирования с помощью метода спектральных элементов \cite{Komatitsch2000}. Для анализа структуры волнового поля в скважинах и более глубокой интерпретации результатов применяется полуаналитический метод конечных элементов (SAFE) \cite{Bartoli2006}. Результаты расчётов сопоставляются с данными работы классического алгоритма Alford rotation и его альтернативной неортогональной модификации \cite{Dellinger1998} с применением оконной и частотной фильтрации и без неё.

\section{Дипольный каротаж скважин и классический подход к обработке}
Классическая схема работы современных приборов дипольного каротажа включает в себя записи от двух источников, ориентированных в некоторых направлениях X и Y, ортогональных друг другу. Запись производится на два массива ориентированных приёмников, как правило имеющих фиксированный шаг смещения вдоль прибора. Таким образом, на выходе устройство формирует четырехкомпонентный вектор измерений, состоящий из двух замеров по направлениям излучения источников (XX и YY) и перекрёстных замеров (XY и YX), где первая буква обозначает ориентацию источника, а вторая - приемников. Обозначим матрицу $2 \times 2$, состоящую из этих компонент, как $\mathbf{R}$ 

$$
	\mathbf{R} = \left(
	\begin{array}{cc}
	\text{XX} & \text{YX} \\
	\text{XY} & \text{YY} \\
	\end{array}
	\right) 
$$

Из решения уравнения Кельвина-Кристоффеля для породы с трансверсально-изотропным типом симметрии известно, что в направлении отличном от направления оси симметрии породы существует три решения для плоских волн (квазипродольная qP, квазипоперечная qSV и чисто поперечная SH волны), имеющих ортогональную поляризацию по отношению друг другу. Дипольным источником внутри скважины в такой породе будут преимущественно возбуждаться две поперечные изгибные моды, обладающие сильной дисперсией, а в низкочастотном пределе имеющие скорость равную скорости qSV и SH волн в породе. Дисперсионные кривые этих мод не имеют пересечений и обе волны (обозначаемые как быстрая и медленная) распространяются независимо вдоль ствола скважины. В рамках классического подхода полагают, что для описания таких волновых процессов в скважине допустимо использование приближения, справедливого для распространения плоских волн в анизотропной недисперсионной среде, математически представленного в форме:

$$
	\mathbf{R} = \mathbf{P}_{M \rightarrow R} \ \mathbf{D} \ \mathbf{P}_{S \rightarrow M} \ \mathbf{S},
$$
где вектор $\mathbf{S}$ характеризует излучение источника, $\mathbf{P}_{S \rightarrow M}$ - матрица, проецирующая вектор источника на главные направления распространения нормальных дипольных мод, $\mathbf{P}_{M \rightarrow R}$ - матрица, проецирующая сигнал чистых мод на направления приемников, $\mathbf{D}$ - матрица, определяющая распространение чистых мод вдоль скважины. В предположении независимости распространения мод, матрица $\mathbf{D}$ будет диагональной. 

В системе координат, связанной с направлениями излучения дипольных источников, вектор $\mathbf{S}$ представляет собой единичную матрицу. Также если системы координат источников и приёмников совпадают, то $\mathbf{P}_{M \rightarrow R}={\mathbf{P}_{S \rightarrow M}}^{T} = \mathbf{P}$. Для матрицы $\mathbf{D}$ в этом случае справедливо

\begin{gather}
	\mathbf{R} = \mathbf{P} \ \mathbf{D} \ \mathbf{P}^T, \label{eq:alford_symmetric} \\ 
	\mathbf{D} = \mathbf{P}^{-1} \ \mathbf{R} \ \mathbf{P}^{-T}.
\end{gather}

Если направления поляризации дипольных волн ортогональны, то существует естественная система координат, связанная с главными направлениями и матрица преобразования $\mathbf{P}$ является простым ортогональным поворотом на некоторый угол $\theta$. 

\begin{equation*}
	\mathbf{P} = \left(
	\begin{array}{cc}
	\cos \theta &-\sin \theta \\ 
	\sin \theta & \cos \theta
	\end{array} 
	\right) 
\end{equation*}

Алгоритм поиска этого угла, основанный на классической модели был представлен в работе \cite{Alford1986} и получил название Alford rotation. На практике полевые данные, однако, не обладают абсолютной симметрией и искомый угол находят из условия минимизации энергии недиагональных компонент по всему интервалу времени измерений. Следует отметить, что данный подход корректно работает только при сохранении ориентации главных направлений вдоль всего пути распространения волн, то есть предполагает однородность и сохранение параметров анизотропного материала на участке акустических измерений.

\section{Нарушение ортогональности}

При выводе основных положений классического Alford rotation был использован ряд предпосылок относительно свойств породы и модели распространения волн, накладывающих ограничения на использование метода. В частности, одним из недостатков такого подхода ряд исследователей называет требование ортогональной поляризации изгибных мод. Между тем в ряде случаев, например при распространении волн в анизотропной породе с орторомбическим типом симметрии \cite{Dellinger2001} или в случае анизотропии вызванной наличием трещин \cite{Nolte1996}, поляризация волн может быть существенно неортогональной. 

Один из возможных вариантов обобщения Alford rotation на неортогональный случай был рассмотрен в работе \cite{Dellinger1998} и заключается в введении дополнительного угла $\eta$, характеризующего ориентацию главных направлений. Утверждается, что если для системы справедливо представление \eqref{eq:alford_symmetric}, то матрицы преобразования будут иметь вид:

\begin{align*}
&\mathbf{P} = \left(
\begin{array}{cc}
\cos \theta & -\sin (\theta+\eta) \\ 
\sin \theta & \cos (\theta+\eta)
\end{array} 
\right) \\
&\mathbf{P}^{-1} = \frac{1}{\cos \eta} \left(
\begin{array}{cc}
\cos (\theta+\eta) & \sin (\theta+\eta) \\ 
-\sin \theta & \cos (\theta)
\end{array} 
\right)
\end{align*}
где, за $\theta$ принимается угол отсчитываемый против часовой стрелки между осью $X$ и направлением поляризации первой моды, а за $\theta + \eta$ - угол между направлением поляризации второй моды и осью $Y$. Поиск значений углов производится путем минимизация энергии недиагональных компонент матрицы $\mathbf{D}$ по двум параметрам. При $\eta=0$ метод сводится к классическому Alford rotation. 

Как известно, нарушение цилиндрической формы ствола скважины в изотропной породе также приводит к разделению изгибных мод и их поляризации вдоль направлений деформации \cite{Seroices2010}. Хотя влияние нециллиндричности практически сходит на нет для низкочастотных гармоник распространяющихся волн, на средних и высоких частотах этот фактор можно рассматривать как дополнительную причину анизотропии в случае, если главные направления анизотропной породы не совпадают с направлениями деформации ствола. Из-за появляющейся частотной зависимости одного из факторов и сильной дисперсии изгибных волн, эффективное направление поляризации может меняться по мере удаления от источника колебаний. Это приводит к нарушению предположения классического метода (а также его неортогонального обобщения) о разделении изгибных мод, и как следствие симметрии матрицы измерений при любых ортогональных преобразованиях. 

Применение методов оконной и частотной фильтрации в ряде случаев может уменьшить ошибку работы классических алгоритмов, тем не менее универсального подхода, способного скорректировать влияние геометрии ствола на точность определения главных направлений анизотропной породы, в настоящее время не предложено. В следующем разделе производится оценка точности ортогонального и неортогонального Alford rotation на основе синтетических данных трехмерного моделирования распространения волн в быстрой трансверсально-изотропной породы в скважинах эллиптического сечения.  

\section{Вычислительный методы}

В качестве исходных данных для проверки работы алгоритмов были использованы результаты моделирования акустических измерений методом спектральных элементов (SEM). Данный метод ранее успешно применялся для расчета задач геофизики \cite{Komatitsch1999} и моделирования акустического каротажа \cite{Charara2011}. Численный алгоритм производит решение уравнений твердого линейно-упругого анизотропного тела в твердых областях и акустических уравнений для невязкой жидкости внутри скважины. На границе раздела сред выполняются условия непрерывности нормальных компонент смещений и отсутствия касательных напряжений. Используемая реализация метода позволяет параметрически задавать высокий порядок аппроксимации по пространству, а также имеет значительные преимущества в скорости расчета по сравнению с другими трехмерными методами.

Для анализа сигнала с приемников и построения дисперсионных кривых нормальных мод используется модификация метода Прони \cite{Ekstrom1995}. Перед обработкой измерений алгоритмом Alford rotation, использовались оконные, низкочастотные и высокочастотные фильтры, построенные с помощью вычислительного комплекса MATLAB. В качестве исходного сигнала для акустического источника в скважине использовалась производная вейвлета Блэкмана-Харриса с несущей частотой 4 кГц. 

Для решения задач распространения упругих волн в однородных анизотропных породах активно применяются спектральные методы, позволяющие аппроксимировать решение волновой задачи в виде суммы его Фурье-гармоник. При исследовании волновых процессов в скважинах достаточно большой длины допустимо также аналогичное разложение решения по пространственным гармоникам в направлении оси скважины. Если направление оси ствола связать с осью Z декартовой системы координат, то решение задачи относительно вектора смещений может быть представлено в виде

$$
	\mathbf{u}(x,y,z,t) = \sum_{\omega} \sum_{k} \mathbf{U}(x,y)\cdot e^{i(kz - \omega t)}
$$
Такое разложение позволяет решать задачу для каждого значения $\omega$ и $k$ независимо. 

Одним из доказавших свою эффективность методов по расчету и анализу волновых процессов в длинных волноводах является полуаналитический метод конечных элементов (SAFE) \cite{Bartoli2006}. В основе метода лежит вариационная форма представления уравнений движения в жидкости и твёрдом анизотропном теле. Аппроксимация значений функции решения с помощью базисных функций на некоторой сетке, позволяет свести систему уравнений движения с граничными условиями к обобщённой задаче на собственные значения. Каждому собственному значению сопоставлено некоторое базисное решение - собственный вектор, соответствующий одной из волновых мод распространяющихся в скважине. Сумма по всем собственным модам, включая затухающие, позволяет получить полное решение волновой задачи, однако для целей данной работы большим преимуществом как раз является возможность раздельного анализа дисперсии и поляризации каждой из нормальных мод. (вопрос выделения решений)

\section{Результаты обработки}

Описанные выше алгоритмы определения угла на главное направление анизотропной породы были опробованы на результатах моделирования каротажных измерений для скважин эллиптического сечения в двух различных породах - Bakken Shale и Cotton Valey Shale. Обе породы относятся к классу глинистых сланцев и часто используются в других исследованиях в качестве модельных быстрых пород. Под быстрой породой понимается материал, в котором скорость распространения поперечных волн превышает скорость звуковых волн в жидкости в скважине. В быстрых породах у дисперсионных кривых дипольных мод отсутствует так называемая частота отсечения, ниже которой волна становится затухающей, поэтому поле лучше поддается анализу на низких частотах. Трансверсально-изотропные породы описываются 5 независимыми упругими постоянными, значения которых приведены в таблице \ref{tab:properties}. Ось симметрии породы наклонена по отношению к оси скважины под углом 90\textdegree (HTI), и в некоторых случаях 60\textdegree (TTI). В плоскости поперечного сечения скважины ось повернута относительно осей эллипса на $\phi = 45$\textdegree, определение этого угла и является задачей алгоритма. В расчетах использовались скважины размерами $12.70 \times 10.16$ см ($10 \times 8$ дюймов) и $15 \times 10$ см с соотношением полуосей эллипса соответственно 25\% и 50\%. Полное описание рассматриваемых моделей можно найти в таблице \ref{tab:models_description}. 

%Параметры быстрой породы, $\rho = 2640$ кг/м$^3$, $V_P = 5219$ м/с, $V_S = 3257$ м/с.
\begin{table}[H]
\footnotesize
\centering
\caption{Параметры упругих анизотропных материалов}
\renewcommand{\arraystretch}{1.5}
\begin{tabularx}{\textwidth}{|C|c|c|c|c|c|c|c|}
\hline \multirow{2}{*}{Название}  & Плотность & \multicolumn{6}{c|}{Упругие модули, ГПа} \\ 
\cline{3-8}  & кг/м$^3$ & $C_{11}$ & $C_{12}$ & $C_{13}$ & $C_{33}$ & $C_{44}$ & $C_{66}$ \\ \hline
\hline Cotton Valey Shale & 2640 & 74.73 & 14.75 & 25.29 & 58.84 & 22.05 & 29.99 \\ 
\hline Bakken Shale & 2230 & 40.9 & 10.3 & 8.5 & 26.9 & 10.5 & 15.3 \\ 
\hline 
\end{tabularx} 
\label{tab:properties}
\renewcommand{\arraystretch}{1.0}
\end{table}

\begin{table}[h]
\footnotesize
\centering
\caption{Параметры модельных задач}
\renewcommand{\arraystretch}{1.5}
\begin{tabularx}{\textwidth}{|C|l|c|l|c|c|}
\hline  Обозначение & Форма скважины & Геометрия & Материал породы & TI угол $\zeta$ & TI угол $\phi$ \\ \hline
\hline \textbf{}\modelnum{\label{mnum: 11}}& Эллиптическая & $10 \times 8$ дьюм & Bakken Shale & 90 & 45 \\
\hline \textbf{}\modelnum{\label{mnum: 10}}& Эллиптическая & $15 \times 10$ см & Bakken Shale & 90 & 45 \\
\hline \textbf{}\modelnum{\label{mnum: 9}}& Эллиптическая & $15 \times 10$ см & Cotton Valey Shale & 90 & 45 \\
\hline \textbf{}\modelnum{\label{mnum: 5}}& Эллиптическая & $15 \times 10$ см & Cotton Valey Shale & 60 & 45 \\ 
\hline 
\end{tabularx}
\label{tab:models_description}
\renewcommand{\arraystretch}{1.0}
\end{table}

По результатам предварительной проверки на случаях эллиптической скважины в изотропной породе и цилиндрической скважины в анизотропной породе, оба алгоритма показали почти идентичные верные направления на оси симметрии анизотропной породы и ориентацию полуосей эллипса, относительная энергия несимметричных компонент повернутой матрицы измерений при этом не превосходит значения $10^{-7}$. 

Как видно из результатов обработки для нецилиндрических моделей, приведенных в таблице \ref{tab:std_process_results}, оба алгоритма дают близкие значения углов с незначительной неортогональностью. Энергия недиагональных компонент составляет порядка 1-3\% для рассмотренных случаев. Несмотря на удовлетворительные качественные показатели работы алгоритмов, значения углов значительно отличаются от заданного значения 45\textdegree.

Применение метода Прони к исходным трассам измерений позволяет выделить в них гармоники с наиболее высокой амплитудой. В моделируемых задачах они соответствуют двум главным дипольным модам. Отображая на графике зависимость скорости этих гармоник от частоты, можно получить дисперсионные кривые, изображённые на рисунках \ref{fig:disp_curves_all}. Для проверки соответствия решений с максимальными амплитудами дипольным модам на график также были нанесены дисперсионные кривые для этих мод, рассчитанные с помощью SAFE. По дисперсионным кривым возможно определить асимптотическое значение скоростей волн на низких частотах, а также выделить частотную область с наиболее высокой дисперсией. Опираясь на данные дисперсионных кривых, в пакете MATLAB были построены низкочастотные и высокочастотные фильтры с конечной импульсной характеристикой (FIR), которые должны были позволить проанализировать поляризацию волнового поля на низких и высоких частотах в отдельности. 

Помимо частотных фильтрации, анализировалось также влияние оконных фильтров, позволяющих выделять информацию с наиболее ранних приходов волн. Из дисперсионных кривых дипольных мод, следует что скорость волны на низких частотах выше. Оконные фильтры зарекомендовали себя, как эффективный инструмент улучшения качества каротажных измерений в большом количестве практически важных случаев, однако из-за малого количества энергии на низких частотах, этот подход в условиях многофакторных возмущений, приводит к большим ошибкам в компонентах измерений и нарушению диагональности матрицы. Как видно из результатов в таблице \ref{tab:filter_process_results}, в недиагональных компонентах при ортогонализации оконных данных остаётся до 20\% энергии волн, что ставит под вопрос точность определения углов.

Применение частотной фильтрации демонстрирует наличие заметной неортогональности между направлениями поляризации дипольных мод на низких частотах. Стоит однако отметить, что оценка угла $\phi$ полученная классическим ортогональным алгоритмом, часто оказывается ближе к реальному значению.

\begin{table}[h]
\footnotesize
\centering
\caption{Результаты расчетов}
\renewcommand{\arraystretch}{1.5}
\begin{tabularx}{\textwidth}{C|rr|rr|r|ll}
				&\multicolumn{1}{c}{$\theta_1^o$} & \multicolumn{1}{c|}{$\theta_1^n$} & \multicolumn{1}{c}{$\theta_2^o$} & \multicolumn{1}{c|}{$\theta_2^n$} & \multicolumn{1}{c|}{$\Delta\theta^n$}& \multicolumn{1}{c}{$E_{cr}^o/E_{t}^o$} & \multicolumn{1}{c}{$E_{cr}^n/E_{t}^n$} \\ \hline
\hline Модель \ref{mnum: 11} & 15.5623 & -74.4377 & 14.7154  & -73.923  & 1.36  & 0.0299 & 0.0298 \\
 	   Модель \ref{mnum: 10} & 8.3898 & -81.6102 & 8.1241 & -81.5622 & 0.3 & 0.01686 & 0.01685 \\
 	   Модель \ref{mnum: 9} & 1.6281 & -88.3719 & 1.7796  & -88.4215  & 0.0  & 0.0064 & 0.0064 \\
	   Модель \ref{mnum: 5} & -88.2731 & -88.2149 & 1.7269  & 1.6286  & 0.15 & 0.0041 & 0.0041 \\ 	   
 	   \hline
\end{tabularx} 
\label{tab:std_process_results}
\renewcommand{\arraystretch}{1.0}
\end{table}

\begin{table}[h]
\footnotesize
\centering
\caption{Результаты расчетов с применением фильтров}
\renewcommand{\arraystretch}{1.5}
\begin{tabularx}{\textwidth}{X|rr|rr|r|ll}
				&\multicolumn{1}{c}{$\theta_1^o$} & \multicolumn{1}{c|}{$\theta_1^n$} & \multicolumn{1}{c}{$\theta_2^o$} & \multicolumn{1}{c|}{$\theta_2^n$} & \multicolumn{1}{c|}{$\Delta\theta^n$}& \multicolumn{1}{c}{$E_{cr}^o/E_{t}^o$} & \multicolumn{1}{c}{$E_{cr}^n/E_{t}^n$} \\ \hline
\hline	\textbf{Модель \ref{mnum: 11}} & \textbf{15.5623} & \textbf{14.7154} & \textbf{-74.4377}  & \textbf{-73.923}  & \textbf{1.36}  & \textbf{0.0299} & \textbf{0.0297} \\
		Модель \ref{mnum: 11} с ОФ \ref{wfnum: 5} & 45.6193 & 63.3189 & -44.3807 & -49.2086  & 22.5  & 0.1198 & 0.0617 \\
		Модель \ref{mnum: 11} с НЧФ \ref{lffnum: 3} & 49.4110 & 40.4599 & -40.5890 & -35.4091  & 14.1 & 0.0204 & 0.0124\\
		Модель \ref{mnum: 11} с ВЧФ \ref{hffnum: 1} & 14.0073 & 13.2547 & -75.9927 & -75.5753  & 1.2 & 0.0039 & 0.0038\\
\hline	\textbf{Модель \ref{mnum: 10}} & \textbf{8.3898} & \textbf{8.1241} & \textbf{-81.6102}  & \textbf{-81.5622} & \textbf{0.3}  & \textbf{0.0169} & \textbf{0.0169} \\
		Модель \ref{mnum: 10} с ОФ \ref{wfnum: 6} & 54.7210 & 68.6300 & -35.2790 & -46.1632  & 24.8  & 0.2115 & 0.1219 \\
		Модель \ref{mnum: 10} с НЧФ \ref{lffnum: 3} & 41.2105 & 25.7145 & -48.7895 & -31.9696  & 32.3 & 0.2210 & 0.1199\\
		Модель \ref{mnum: 10} с ВЧФ \ref{hffnum: 2} & 7.5375 & 10.2188 & -82.4625 & -82.6270  & 2.84 & 0.0110 & 0.0101\\
\hline	\textbf{Модель \ref{mnum: 9}} & \textbf{1.6281} & \textbf{1.7796} & \textbf{-88.3719}  & \textbf{-88.4215}  & \textbf{0.0}  & \textbf{0.0064} & \textbf{0.0064} \\
		Модель \ref{mnum: 9} с ОФ \ref{wfnum: 3} & 49.405 & 58.614 & -40.595 & -54.798  & 23.4  & 0.1297 & 0.0691 \\
		Модель \ref{mnum: 9} с ОФ \ref{wfnum: 4} & 2.5785 & 2.9429 & -87.422 & -87.524  & 0.46  & 0.0088 & 0.0088 \\
		Модель \ref{mnum: 9} с НЧФ \ref{lffnum: 1} & 2.4372 & 2.1617 & -87.5628 & -74.4739  & 13.4  & 0.0132 & 0.0098 \\
\hline  \textbf{Модель \ref{mnum: 5}} 	& \textbf{-88.2731} & \textbf{-88.2149} & \textbf{1.7269} & \textbf{1.6286} & \textbf{0.15} & \textbf{0.0041} & \textbf{0.0041} \\
		Модель \ref{mnum: 5} с окном \ref{wfnum: 2}  & -53.6211 & -62.9063 & 36.3789 & 49.2159 & 22.1 & 0.1951 & 0.1362 \\
	    Модель \ref{mnum: 5} с НЧФ \ref{lffnum: 1}  	& -87.7936 & -73.4542 & 2.2064 & 2.1189 & 14.4 & 0.0107 & 0.0084 \\		
\hline	
\end{tabularx} 
\label{tab:filter_process_results}
\renewcommand{\arraystretch}{1.0}
\end{table}


\section{Сравнение с SAFE}

На рисунках \ref{fig:bs10_8_HTI45} и \ref{fig:bs15_10_HTI45} приведена визуализация амплитуды давления собственных векторов, относящихся к двум дипольным модам внутри скважины. Направление градиента отражает ориентацию поляризации каждой из волн. Как можно заметить, поляризация обеих моды обладает заметной зависимостью от частоты. Заметим также, что поляризация на низких частотах практически не отличается для случаев с эллиптичностью 25\% и 50\%. Неортогональность этих направлений имеет наиболее сильный характер в диапазоне частот от 2 до 4 кГц для рассматриваемых случаев. На полученные профили амплитуд нанесены результаты обработки данных из таблицы \ref{tab:filter_process_results}: для частот 1.94 кГц и 3.29 кГц нанесены результаты с применением низкочастотной фильтрации и без, для частот 5.52 кГц и 8.65 кГц - высокочастотной фильтрации и без неё. 

\begin{figure}[h]
\centering
\begin{minipage}{0.49\linewidth}
	\centering \textbf{Модель \ref{mnum: 11}}
	\psfragfig[width=0.49\linewidth,crop=pdfcrop]{./images/nonorth_alford/el10x8_inch_HTI_BS_f45_disp_modes+SAFE} \\
\end{minipage}
\begin{minipage}{0.49\linewidth}
	\centering \textbf{Модель \ref{mnum: 10}}
	\psfragfig[width=0.49\linewidth,crop=pdfcrop]{./images/nonorth_alford/el15x10_HTI_BS_f45_disp_modes+SAFE} \\
\end{minipage}
%\begin{minipage}{0.49\linewidth}
%	\centering \textbf{Модель \ref{mnum: 12}}
%	\psfragfig[width=0.49\linewidth,crop=pdfcrop]{./images/nonorth_alford/el10x8_inch_HTI_BS_f90_disp_modes+SAFE} \\
%\end{minipage}
\begin{minipage}{0.49\linewidth}
	\centering \textbf{Модель \ref{mnum: 9}}
	\psfragfig[width=0.49\linewidth,crop=pdfcrop]{./images/nonorth_alford/el15x10_HTI_CS_f45_disp_modes+SAFE} \\
\end{minipage}
\caption{Дисперсионные кривые для основных задач. }
\label{fig:disp_curves_all}
\end{figure}

\begin{figure}[h]
\centering
\begin{minipage}{0.24\linewidth}
	\psfragfig[width=0.24\linewidth,crop=pdfcrop]{./images/SAFE/SAFE_BS_10x8_HTI_45/P_s_2kHz}		
\end{minipage}
\begin{minipage}{0.24\linewidth}
	\psfragfig[width=0.24\linewidth,crop=pdfcrop]{./images/SAFE/SAFE_BS_10x8_HTI_45/P_s_3_3kHz}		
\end{minipage}
\begin{minipage}{0.24\linewidth}
	\psfragfig[width=0.24\linewidth,crop=pdfcrop]{./images/SAFE/SAFE_BS_10x8_HTI_45/P_s_5_5kHz}		
\end{minipage}
\begin{minipage}{0.24\linewidth}
	\psfragfig[width=0.24\linewidth,crop=pdfcrop]{./images/SAFE/SAFE_BS_10x8_HTI_45/P_s_8_6kHz}		
\end{minipage}
\begin{minipage}{0.24\linewidth}
	\psfragfig[width=0.24\linewidth,crop=pdfcrop]{./images/SAFE/SAFE_BS_10x8_HTI_45/P_a_2kHz}		
\end{minipage}
\begin{minipage}{0.24\linewidth}
	\psfragfig[width=0.24\linewidth,crop=pdfcrop]{./images/SAFE/SAFE_BS_10x8_HTI_45/P_a_3_3kHz}		
\end{minipage}
\begin{minipage}{0.24\linewidth}
	\psfragfig[width=0.24\linewidth,crop=pdfcrop]{./images/SAFE/SAFE_BS_10x8_HTI_45/P_a_5_5kHz}		
\end{minipage}
\begin{minipage}{0.24\linewidth}
	\psfragfig[width=0.24\linewidth,crop=pdfcrop]{./images/SAFE/SAFE_BS_10x8_HTI_45/P_a_8_6kHz}		
\end{minipage}
\vspace{\baselineskip}
\renewcommand{\arraystretch}{1.0}
\footnotesize
\begin{tabular*}{\textwidth}{@{\extracolsep{\fill} }clclcl}
\tikz \draw (0,0) -- (1cm,0); & ортогональный & \tikz \draw[dashed] (0,0) -- (1cm,0); & ортогональный & \tikz \draw[dashdotted] (0,0) -- (1cm,0); & неортогональный    \\
& без фильтрации & & с фильтрацией & & с фильтрацией \\
\end{tabular*}
\renewcommand{\arraystretch}{1.0}
\normalsize
\caption{Результаты расчетов собственных векторов для Модели \ref{mnum: 11}}
\label{fig:bs10_8_HTI45}
\end{figure}

\begin{figure}[h]
\centering
\begin{minipage}{0.24\linewidth}
	\psfragfig[width=0.24\linewidth,crop=pdfcrop]{./images/SAFE/SAFE_BS_15x10_HTI_45/P_s_2kHz}		
\end{minipage}
\begin{minipage}{0.24\linewidth}
	\psfragfig[width=0.24\linewidth,crop=pdfcrop]{./images/SAFE/SAFE_BS_15x10_HTI_45/P_s_3_3kHz}		
\end{minipage}
\begin{minipage}{0.24\linewidth}
	\psfragfig[width=0.24\linewidth,crop=pdfcrop]{./images/SAFE/SAFE_BS_15x10_HTI_45/P_s_5_5kHz}		
\end{minipage}
\begin{minipage}{0.24\linewidth}
	\psfragfig[width=0.24\linewidth,crop=pdfcrop]{./images/SAFE/SAFE_BS_15x10_HTI_45/P_s_8_6kHz}		
\end{minipage}
\begin{minipage}{0.24\linewidth}
	\psfragfig[width=0.24\linewidth,crop=pdfcrop]{./images/SAFE/SAFE_BS_15x10_HTI_45/P_a_2kHz}		
\end{minipage}
\begin{minipage}{0.24\linewidth}
	\psfragfig[width=0.24\linewidth,crop=pdfcrop]{./images/SAFE/SAFE_BS_15x10_HTI_45/P_a_3_3kHz}		
\end{minipage}
\begin{minipage}{0.24\linewidth}
	\psfragfig[width=0.24\linewidth,crop=pdfcrop]{./images/SAFE/SAFE_BS_15x10_HTI_45/P_a_5_5kHz}		
\end{minipage}
\begin{minipage}{0.24\linewidth}
	\psfragfig[width=0.24\linewidth,crop=pdfcrop]{./images/SAFE/SAFE_BS_15x10_HTI_45/P_a_8_6kHz}		
\end{minipage}
\vspace{\baselineskip}
\renewcommand{\arraystretch}{1.0}
\footnotesize
\begin{tabular*}{\textwidth}{@{\extracolsep{\fill} }clclcl}
\tikz \draw (0,0) -- (1cm,0); & ортогональный & \tikz \draw[dashed] (0,0) -- (1cm,0); & ортогональный & \tikz \draw[dashdotted] (0,0) -- (1cm,0); & неортогональный    \\
& без фильтрации & & с фильтрацией & & с фильтрацией \\
\end{tabular*}
\renewcommand{\arraystretch}{1.0}
\normalsize
\caption{Результаты расчетов собственных векторов для Модели \ref{mnum: 10}}
\label{fig:bs15_10_HTI45}
\end{figure}

Из представленных данных хорошо заметно, что неортогональная версия Alford rotation дает наиболее близкие оценки направлений поляризации дипольных волн на низких частотах. Этому вероятно способствует малое количество энергии в волнах на частотах ниже 1.5 кГц, а также сравнительно малый вклад узкой переходной области средних частот (3-4 кГц). Эти направления не совпадают с заданной ориентацией оси симметрии трансверсально-изотропной породы, а более близкие значения классического ортогонального алгоритма можно объяснить тем, что полученные ортогональные значения ориентаций ближе всего находятся реальным поляризациям мод на этих частотах. В пользу последнего утверждения также говорит и тот факт, что энергия недиагональных компонент в ортогональном случае приблизительно на 10\% выше. 

В целом же можно твердо сказать, что направления поляризации в рассмотренных задачах полностью определяются ориентацией мод на высоких частотах. Интересно, что ориентация мод на высоких частотах почти ортогональна, но не совпадает геометрически с ориентацией полуосей эллипса поперечного сечения скважины, как в случае с изотропной породой. При увеличении степени эллиптичности ствола это различие сокращается. 


\section{Заключение}

Результаты обработки модельных задач в быстрых породах ортогональными и неортогональными методами основанными на диагонализации матрицы измерений, как следует из данного исследования, могут быть достаточно точными даже для случаев с явной частотной зависимостью поляризации волн. При этом на примере расчета задачи нецилиндрической скважины в породе Bakken shale можно видеть, что эти результаты могут не соответствовать главным направлениям анизотропной породы, что поднимает вопрос о физическом обосновании этого измеряемого параметра.

Применение частотной фильтрации позволяет лучше улавливать поляризацию волн, связанную с феноменом анизотропии породы, однако требует учета возможной неортогональности этих направлений. При исследовании пород с высокой степенью симметрии тензора упругих постоянных, ортогональность на низких частотах можно считать маркером корректности решения задачи о нахождении направления оси симметрии. 

Важным результатом данной работы является оценка точности работы упомянутых алгоритмов, а также демонстрация возможного существования ортогонально поляризованных волн в быстрых породах,  не связанных однозначно с одним из факторов. Для дипольных мод на средних частотах существует область с достаточно резкой сменой направлений поляризации, которая однако не имеет определяющего значения для работы алгоритма, так как спектр используемых источников значительно шире.

Приведенный в статье материал демонстрирует возможности анализа поляризации волн с помощью полуаналитического метода конечных элементов (SAFE). При наличии данных о геометрии скважины и неортогональности главных направлений изгибных волн, данный метод может быть использован для коррекции результатов обработки каротажных измерений в скважинах. Сведения об ориентации отдельных мод, полученные в рамках данного подхода, могут быть полезны для задач инверсии параметров упругой среды. 
%\include{include/tmp_short_description}
%\include{include/tmp_safe_pictures}

\clearpage
%\bibliography{./library/library}
%\include{include/var_bibliography_link}
\bibliography{c:/Users/German/Documents/TeX_Library/library}
%\bibliography{d:/Documents/Workfiles/Literature/TeX_Library/library}

\bibliographystyle{unsrt}
%\bibliographystyle{plainnat_no_url}

\appendix
\section{Фильтрация данных}

\begin{minipage}[c]{0.47\linewidth}	
\begin{center}
		Ортогональный Alford rotation \\
		\psfragfig[width=0.40\linewidth,crop=pdfcrop]{./images/nonorth_alford/el20x10_TTI60_rot4c_scheme}			
	  		\label{fig:rot4_scheme}
\end{center}	  		
\end{minipage} \hfill
\begin{minipage}[c]{0.47\linewidth}
\begin{center}
		Неортогональный Alford rotation\\
			\psfragfig[width=0.40\linewidth,crop=pdfcrop]{./images/nonorth_alford/el20x10_TTI60_gs_rot4c_scheme}
			\label{fig:rot4_gs_scheme}
\end{center}
\end{minipage} 	\\
\include{include/tmp_filter_tables}

\end{document} 