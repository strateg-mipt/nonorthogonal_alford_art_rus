% !TeX spellcheck = ru_RU
\documentclass[a4paper,11pt]{article}
\usepackage[process=auto]{pstool}
\usepackage[english,russian]{babel}
\usepackage[T2A]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{amssymb,amsmath}
\usepackage{gensymb,textcomp,latexsym}
\usepackage{graphicx}
\usepackage{tabularx}
\usepackage[pdftex, left=1in, right=1in, top=1in, bottom=2cm]{geometry}
\usepackage{parcolumns}
\usepackage{multirow}
\usepackage{tikz}

%\usepackage[usenames,dvipsnames]{xcolor}
%\usepackage[font=small,labelfont=bf]{caption}
\usepackage[center]{subfigure}
\renewcommand{\thesubfigure}{(\asbuk{subfigure})~}
\newcommand{\figref}[1]{Рис.~\ref{#1}}
\usepackage[pdfauthor={Shchelik},pdftitle={Nonorthogonal Alford test},pdfstartview=XYZ,bookmarks=true,colorlinks=true,linkcolor=blue,urlcolor=blue,citecolor=blue,
bookmarks=true,linktocpage=true,hyperindex=true]{hyperref}
%\usepackage[hyperpageref]{backref}

%\usepackage[section]{placeins}
%\usepackage{graphicx}
%\usepackage{epsfig}
%\usepackage{epstopdf}
%\usepackage{subfigure}
%\usepackage{float}
%\usepackage{booktabs}
%\graphicspath{ {./image_test/} }

\newcounter{modelnum}
\newcommand{\modelnum}[1]{\refstepcounter{modelnum}Модель \themodelnum #1}
%tabularx options
\newcolumntype{C}{>{\centering}X}


\begin{document}
\part*{Неортогональный Alford rotation}
\today

%К вопросу о поляризации дипольных мод в нецилиндрических скважинах в анизотропной породе.
%
%- Введение
%    Обсуждение методики дипольного каротажа, задача определения направлений основных осей трансверсально-анизотропной породы. Обзор темы существования главных направлений в нецилиндрических скважинах. Феномен неортогональности, алгоритмы разделения мод. 
%
%- Дипольные моды в анизотропной среде. Дисперсионный подход, стандартный алгоритм Alford rotation. Феномен неортогональности, алгоритмы разделения мод. 
%- Неортогональность главных направлений и альтернативный метод обработки NOAR. Зависимость от частоты. Фильтрация сигнала.
%- SAFE как метод изучения отдельных базисных решений. Описание и применение
%
%- Сравнение результатов SAFE и NOAR.
%
%- Заключение.

\section{Введение}
Уже несколько десятилетий в акустическом каротаже широко и достаточно успешно практикуются методики кросс-дипольных измерений. Современные решения в технике и обработке полученных данных позволяют количественно производить оценку азимутальной и аксиальной (по отношению к стволу скважины) анизотропии для широкой группы горных пород. Существенный прогресс в определении параметров породы в рамках модели трансверсально-изотропного тела по скоростям распространения поперечных волн называется рядом специалистов главным достижением методов акустического каротажа последних лет. Помимо изучения внутренней анизотропии горной породы, кросс-дипольные измерения могут быть использованы для определения ориентации трещин и обнаружения анизотропии, индуцированной подземными горизонтальными напряжениями \cite{Patterson2001}.

Как известно, принцип работы данного метода основан на существовании в анизотропной породе двух ортогональных выделенных направлений, что в общем случае приводит к поляризации распространяющихся по стволу скважины поперечных волн. При наличии измерений от двух ортогонально-ориентированных направленных дипольных источников в скважине возможно определить направления главных осей анизотропии и скорости распространения поляризованных поперечных волн. В основе классического метода определения лежит допущение о симметричности матрицы составленной из компонент четырёх векторов измерений различной ориентации, которая может быть приведена к диагональному виду ортогональным поворотом на некоторый угол \cite{Alford1986}. В ряде практических случаев ортогональность направлений поляризации поперечных волн отсутствует, однако в однородной породе матрица измерений должна сохранять симметрию и может быть диагонализирована другими способами \cite{Dellinger1998}. Помимо неортогональности на результат работы классического алгоритма может влиять наличие сильных горизонтальных напряжений, приводящих к возникновению индуцированной анизотропии и эффекту пересечения дисперсионных кривых быстрой и медленной волн. В этом случае результат работы алгоритма становится зависимым от ширины временного окна при обработки, а следовательно направление поляризации волн изменяется с ростом частоты \cite{Nolte1997}. Другим фактором, влияющим на поляризацию и разделение волн в скважине, является неидеально цилиндрическая форма поперечного сечения ствола \cite{Seroices2010}. В сочетании с анизотропными свойствами горной породы отклонения от цилиндрической формы могут приводить к проблемам определения направлений главных осей стандартными методами [?].

В данной работе обсуждается вопрос определения главных направлений трансверсально-изотропной породы по измерениям в скважинах эллиптического сечения, являющихся модельным приближением более общих несимметричных форм скважин. В качестве исходных данных используются результаты численного трёхмерного моделирования с помощью метода спектральных элементов \cite{Komatitsch2000}. Для анализа структуры волнового поля в скважинах и более глубокой интерпретации результатов применяется полуаналитический метод конечных элементов (SAFE) \cite{Bartoli2006}. Результаты расчётов сопоставляются с данными работы классического алгоритма Alford rotation и его альтернативной неортогональной модификации \cite{Dellinger1998} с применением оконной и частотной фильтрации и без неё.

\section{Дипольный каротаж скважин и классический подход к обработке}
Классическая схема работы современных приборов дипольного каротажа включает в себя записи от двух источников, ориентированных в некоторых направлениях X и Y, ортогональных друг другу. Запись производится на два массива ориентированных приёмников, как правило имеющих фиксированный шаг смещения вдоль прибора. Таким образом, на выходе устройство формирует четырехкомпонентный вектор измерений, состоящий из двух замеров по направлениям излучения источников (XX и YY) и перекрёстных замеров (XY и YX), где первая буква обозначает ориентацию источника, а вторая - приемников. Обозначим матрицу $2 \times 2$, состоящую из этих компонент, как $\mathbf{R}$ 

$$
	\mathbf{R} = \left(
	\begin{array}{cc}
	\text{XX} & \text{YX} \\
	\text{XY} & \text{YY} \\
	\end{array}
	\right) 
$$

Из решения уравнения Кельвина-Кристоффеля для породы с трансверсально-изотропным типом симметрии известно, что в направлении отличном от направления оси симметрии породы существует три решения для плоских волн (квазипродольная qP, квазипоперечная qSV и чисто поперечная SH волны), имеющих ортогональную поляризацию по отношению друг другу. Дипольным источником внутри скважины в такой породе будут преимущественно возбуждаться две поперечные изгибные моды, обладающие сильной дисперсией, а в низкочастотном пределе имеющие скорость равную скорости qSV и SH волн в породе. Дисперсионные кривые этих мод не имеют пересечений и обе волны (обозначаемые как быстрая и медленная) распространяются независимо вдоль ствола скважины. В рамках классического подхода полагают, что для описания таких волновых процессов в скважине допустимо использование приближения, справедливого для распространения плоских волн в анизотропной недисперсионной среде, математически представленного в форме:

$$
	\mathbf{R} = \mathbf{P}_{M \rightarrow R} \ \mathbf{D} \ \mathbf{P}_{S \rightarrow M} \ \mathbf{S},
$$
где вектор $\mathbf{S}$ характеризует излучение источника, $\mathbf{P}_{S \rightarrow M}$ - матрица, проецирующая вектор источника на главные направления распространения нормальных дипольных мод, $\mathbf{P}_{M \rightarrow R}$ - матрица, проецирующая сигнал чистых мод на направления приемников, $\mathbf{D}$ - матрица, определяющая распространение чистых мод вдоль скважины. В предположении независимости распространения мод, матрица $\mathbf{D}$ будет диагональной. 

В системе координат, связанной с направлениями излучения дипольных источников, вектор $\mathbf{S}$ представляет собой единичную матрицу. Также если системы координат источников и приемников совпадают, то $\mathbf{P}_{M \rightarrow R}={\mathbf{P}_{S \rightarrow M}}^{T} = \mathbf{P}$. Для матрицы $\mathbf{D}$ в этом случае справедливо

\begin{gather}
	\mathbf{R} = \mathbf{P} \ \mathbf{D} \ \mathbf{P}^T, \label{eq:alford_symmetric} \\ 
	\mathbf{D} = \mathbf{P}^{-1} \ \mathbf{R} \ \mathbf{P}^{-T}.
\end{gather}

Если направления поляризации дипольных волн ортогональны, то существует естественная система координат, связанная с главными направлениями и матрица преобразования $\mathbf{P}$ является простым ортогональным поворотом на некоторый угол $\theta$. 

\begin{equation*}
	\mathbf{P} = \left(
	\begin{array}{cc}
	\cos \theta &-\sin \theta \\ 
	\sin \theta & \cos \theta
	\end{array} 
	\right) 
\end{equation*}

Алгоритм поиска этого угла, основанный на классической модели был представлен в работе \cite{Alford1986} и получил название Alford rotation. На практике полевые данные, однако, не обладают абсолютной симметрией и искомый угол находят из условия минимизации энергии недиагональных компонент по всему интервалу времени измерений. Следует отметить, что данный подход корректно работает только при сохранении ориентации главных направлений вдоль всего пути распространения волн, то есть предполагает однородность и сохранение параметров анизотропного материала на участке акустических измерений.

\section{Нарушение ортогональности}

При выводе основных положений классического Alford rotation был использован ряд предпосылок относительно свойств породы и модели распространения волн, накладывающих ограничения на использование метода. В частности, одним из недостатков такого подхода ряд исследователей называет требование ортогональной поляризации изгибных мод. Между тем в ряде случаев, например при распространении волн в анизотропной породе с орторомбическим типом симметрии \cite{Dellinger2001} или в случае анизотропии вызванной наличием трещин \cite{Nolte1996}, поляризация волн может быть существенно неортогональной. 

Один из возможных вариантов обобщения Alford rotation на неортогональный случай был рассмотрен в работе \cite{Dellinger1998} и заключается в введении дополнительного угла $\eta$, характеризующего ориентацию главных направлений. Утверждается, что если для системы справедливо представление \eqref{eq:alford_symmetric}, то матрицы преобразования будут иметь вид:

\begin{align*}
&\mathbf{P} = \left(
\begin{array}{cc}
\cos \theta & -\sin (\theta+\eta) \\ 
\sin \theta & \cos (\theta+\eta)
\end{array} 
\right) \\
&\mathbf{P}^{-1} = \frac{1}{\cos \eta} \left(
\begin{array}{cc}
\cos (\theta+\eta) & \sin (\theta+\eta) \\ 
-\sin \theta & \cos (\theta)
\end{array} 
\right)
\end{align*}
где, за $\theta$ принимается угол отсчитываемый против часовой стрелки между осью $X$ и направлением поляризации первой моды, а за $\theta + \eta$ - угол между направлением поляризации второй моды и осью $Y$. Поиск значений углов производится путем минимизация энергии недиагональных компонент матрицы $\mathbf{D}$ по двум параметрам. При $\eta=0$ метод сводится к классическому Alford rotation. 

Как известно, нарушение цилиндрической формы ствола скважины в изотропной породе также приводит к разделению изгибных мод и их поляризации вдоль направлений деформации \cite{Seroices2010}. Хотя влияние нециллиндричности практически сходит на нет для низкочастотных гармоник распространяющихся волн, на средних и высоких частотах этот фактор можно рассматривать как дополнительную причину анизотропии в случае, если главные направления анизотропной породы не совпадают с направлениями деформации ствола. Из-за появляющейся частотной зависимости одного из факторов и сильной дисперсии изгибных волн, эффективное направление поляризации может меняться по мере удаления от источника колебаний. Это приводит к нарушению предположения классического метода (а также его неортогонального обобщения) о разделении изгибных мод, и как следствие симметрии матрицы измерений при любых ортогональных преобразованиях. 

Применение методов оконной и частотной фильтрации в ряде случаев может уменьшить ошибку работы классических алгоритмов, тем не менее универсального подхода, способного скорректировать влияние геометрии ствола на точность определения главных направлений анизотропной породы, в настоящее время не предложено. В следующем разделе производится оценка точности ортогонального и неортогонального Alford rotation на основе синтетических данных трехмерного моделирования распространения волн в быстрой трансверсально-изотропной породы в скважинах эллиптического сечения.  

\section{Вычислительный методы}

В качестве исходных данных для проверки работы алгоритмов были использованы результаты моделирования акустических измерений методом спектральных элементов (SEM). Данный метод ранее успешно применялся для расчета задач геофизики \cite{Komatitsch1999} и моделирования акустического каротажа \cite{Charara2011}. Численный алгоритм производит решение уравнений твердого линейно-упругого анизотропного тела в твердых областях и акустических уравнений для невязкой жидкости внутри скважины. На границе раздела сред выполняются условия непрерывности нормальных компонент смещений и отсутствия касательных напряжений. Используемая реализация метода позволяет параметрически задавать высокий порядок аппроксимации по пространству, а также имеет значительные преимущества в скорости расчета по сравнению с другими трехмерными методами.

Для анализа сигнала с приемников и построения дисперсионных кривых нормальных мод используется модификация метода Прони \cite{Ekstrom1995}. Перед обработкой измерений алгоритмом Alford rotation, использовались оконные, низкочастотные и высокочастотные фильтры, построенные с помощью вычислительного комплекса MATLAB. В качестве исходного сигнала для акустического источника в скважине использовалась производная вейвлета Блэкмана-Харриса с несущей частотой 4 кГц. 

\section{Результаты обработки}

\section{SAFE}

Для решения задач распространения упругих волн в однородных анизотропных породах активно применяются спектральные методы, позволяющие аппроксимировать решение волновой задачи в виде суммы его Фурье-гармоник. При исследовании волновых процессов в скважинах достаточно большой длины допустимо также аналогичное разложение решения по пространственным гармоникам в направлении оси скважины. Если направление оси ствола связать с осью Z декартовой системы координат, то решение задачи относительно вектора смещений может быть представлено в виде

$$
	\mathbf{u}(x,y,z,t) = \sum_{\omega} \sum_{k} \mathbf{U}(x,y)\cdot e^{i(kz - \omega t)}
$$
Такое разложение позволяет решать задачу для каждого значения $\omega$ и $k$ независимо. 

Одним из доказавших свою эффективность методов по расчету и анализу волновых процессов в длинных волноводах является полуаналитический метод конечных элементов (SAFE) \cite{Bartoli2006}. В основе метода лежит вариационная форма представления уравнений движения в жидкости и твердом анизотропном теле. Аппроксимация значений функции решения с помощью базисных функций на некоторой сетке, позволяет свести систему уравнений движения с граничными условиями к обобщенной задаче на собственные значения. Каждому собственному значению сопоставлено некоторое базисное решение - собственный вектор, соответствующий одной из волновых мод распространяющихся в скважине. Сумма по всем собственным модам, включая затухающие, позволяет получить полное решение волновой задачи, однако для целей данной работы большим преимуществом как раз является возможность раздельного анализа дисперсии и поляризации каждой из нормальных мод. (вопрос выделения решений)

\section{Сравнение с SAFE}

\section{Заключение}

%\include{include/tmp_short_description}

\include{include/tmp_model_tables}

\include{include/tmp_results_tables}




\section{Фильтрация данных}

\include{include/tmp_filter_tables}

\begin{minipage}[c]{0.47\linewidth}	
\begin{center}
		Ортогональный Alford rotation \\
		\psfragfig[width=0.40\linewidth,crop=pdfcrop]{./images/nonorth_alford/el20x10_TTI60_rot4c_scheme}			
	  		\label{fig:rot4_scheme}
\end{center}	  		
\end{minipage} \hfill
\begin{minipage}[c]{0.47\linewidth}
\begin{center}
		Неортогональный Alford rotation\\
			\psfragfig[width=0.40\linewidth,crop=pdfcrop]{./images/nonorth_alford/el20x10_TTI60_gs_rot4c_scheme}
			\label{fig:rot4_gs_scheme}
\end{center}
\end{minipage} 	\\

%\include{include/tmp_safe_pictures}

%\bibliography{./library/library}
%\include{include/var_bibliography_link}
%\bibliography{c:/Users/German/Documents/TeX_Library/library}
\bibliography{d:/Documents/Workfiles/Literature/TeX_Library/library}

\bibliographystyle{unsrt}
%\bibliographystyle{plainnat_no_url}



\end{document} 